import{a as Br,b as ft,c as Wr,ca as Vr,d as g,e as M,f as d,g as p,h as ve,i as I,j as N,k as jr,m as Hr,o as ke,p as $e}from"./chunk-IJ2NUXZ7.js";import{d as ui,e as ci,g as xe}from"./chunk-7QKZJC6O.js";var bo=ui((wo,Ot)=>{"use strict";(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof Ot<"u"&&Ot.exports?Ot.exports=t():e.sha256=t()})(wo,function(){var e=function t(r){function n(Ur,Fr){return Ur>>>Fr|Ur<<32-Fr}for(var o=Math.pow,i=o(2,32),a="length",s,u,l="",c=[],m=r[a]*8,h=t.h=t.h||[],w=t.k=t.k||[],b=w[a],y={},_=2;b<64;_++)if(!y[_]){for(s=0;s<313;s+=_)y[s]=_;h[b]=o(_,.5)*i|0,w[b++]=o(_,.3333333333333333)*i|0}for(r+="\x80";r[a]%64-56;)r+="\0";for(s=0;s<r[a];s++){if(u=r.charCodeAt(s),u>>8)return;c[s>>2]|=u<<(3-s)%4*8}for(c[c[a]]=m/i|0,c[c[a]]=m,u=0;u<c[a];){var E=c.slice(u,u+=16),A=h;for(h=h.slice(0,8),s=0;s<64;s++){var Z=s+u,K=E[s-15],fe=E[s-2],ee=h[0],de=h[4],Dr=h[7]+(n(de,6)^n(de,11)^n(de,25))+(de&h[5]^~de&h[6])+w[s]+(E[s]=s<16?E[s]:E[s-16]+(n(K,7)^n(K,18)^K>>>3)+E[s-7]+(n(fe,17)^n(fe,19)^fe>>>10)|0),si=(n(ee,2)^n(ee,13)^n(ee,22))+(ee&h[1]^ee&h[2]^h[1]&h[2]);h=[Dr+si|0].concat(h),h[4]=h[4]+Dr|0}for(s=0;s<8;s++)h[s]=h[s]+A[s]|0}for(s=0;s<8;s++)for(u=3;u+1;u--){var Rr=h[s]>>u*8&255;l+=(Rr<16?0:"")+Rr.toString(16)}return l};return e.code='var sha256=function a(b){function c(a,b){return a>>>b|a<<32-b}for(var d,e,f=Math.pow,g=f(2,32),h="length",i="",j=[],k=8*b[h],l=a.h=a.h||[],m=a.k=a.k||[],n=m[h],o={},p=2;64>n;p++)if(!o[p]){for(d=0;313>d;d+=p)o[d]=p;l[n]=f(p,.5)*g|0,m[n++]=f(p,1/3)*g|0}for(b+="\\x80";b[h]%64-56;)b+="\\x00";for(d=0;d<b[h];d++){if(e=b.charCodeAt(d),e>>8)return;j[d>>2]|=e<<(3-d)%4*8}for(j[j[h]]=k/g|0,j[j[h]]=k,e=0;e<j[h];){var q=j.slice(e,e+=16),r=l;for(l=l.slice(0,8),d=0;64>d;d++){var s=q[d-15],t=q[d-2],u=l[0],v=l[4],w=l[7]+(c(v,6)^c(v,11)^c(v,25))+(v&l[5]^~v&l[6])+m[d]+(q[d]=16>d?q[d]:q[d-16]+(c(s,7)^c(s,18)^s>>>3)+q[d-7]+(c(t,17)^c(t,19)^t>>>10)|0),x=(c(u,2)^c(u,13)^c(u,22))+(u&l[1]^u&l[2]^l[1]&l[2]);l=[w+x|0].concat(l),l[4]=l[4]+w|0}for(d=0;8>d;d++)l[d]=l[d]+r[d]|0}for(d=0;8>d;d++)for(e=3;e+1;e--){var y=l[d]>>8*e&255;i+=(16>y?0:"")+y.toString(16)}return i};',e})});var Gr={production:!0,BASE_API:"https://sensorsoft.net/line-messaging",BASE_RESOURCE_URI:"https://highwaydistrict.com/skydam/skydam-resources/survey",BASE_RESOURCE_DAM_URI:"https://highwaydistrict.com/skydam/skydam-resources/dam-survey",MAPBOX_API_KEY:"pk.eyJ1Ijoib2Zzb2x1dGlvbnMiLCJhIjoiY2xsb2x2MDFrMGViaDNtbXFuMzhqNzh5bSJ9.dAjWBIWa1Z5NYza_DsVKGQ",MY_QRCODE_URL:"assets/images/qr-scan.png",host:"https://api.onfarmsolution.com",pathApi:"/onfarm-websocket-api/",WebSocket:{host:"https://api.onfarmsolution.com",path:"/onfarm-websocket/"}};var qr=(()=>{let t=class t{constructor(){this._observe=new Br}get watchUserAccount(){return new ft(n=>{this._observe=n})}get activeUser(){return this._activeUser}setActiveUser(n){this._activeUser=n;try{this._observe.next(this._activeUser)}catch{}}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=ke({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Me=class{constructor(){this.twoDigi=t=>"0".concat(t).slice(-2)}genFormData(t,r,n){let o=r||new FormData;for(let i in t)if(t.hasOwnProperty(i)&&t[i]!=null&&t[i]!==void 0){let a=n?"".concat(n,"[").concat(i,"]"):i;t[i]instanceof Date?o.append(a,t[i].toISOString()):typeof t[i]=="object"&&!(t[i]instanceof File)?this.genFormData(t[i],o,a):o.append(a,t[i]);continue}return o}dateTimeFormat(t,r=!0){if(!t)return"";let n="".concat(this.twoDigi(t.getHours()),":").concat(this.twoDigi(t.getMinutes()),":00");return"".concat(t.getFullYear(),"-").concat(this.twoDigi(t.getMonth()+1),"-").concat(this.twoDigi(t.getDate())).concat(r?" "+n:"")}getLiffId(){let t=sessionStorage.getItem("liffId");if(t)return JSON.parse(t)}setLiffId(t){sessionStorage.setItem("liffId",JSON.stringify(t))}};var Jr=(()=>{let t=class t{constructor(n){this.http=n,this.baseURI=Gr.BASE_API,this.tools=new Me}user(n){let o=this.tools.genFormData(n);return this.http.post("".concat(this.baseURI,"/logs/user"),o)}setUser(n){return console.log(":: profile ::",n),this.http.put("".concat(this.baseURI,"/logs/user"),n)}SocialLogin(n){let o="".concat(this.baseURI,"/auth/signIn/").concat(n);return this.http.get(o)}RegisterLiff(n){let o=this.tools.genFormData(n),i="".concat(this.baseURI,"/auth/register-liff");return this.http.post(i,o)}UpdateUser(n){let o="".concat(this.baseURI,"/auth/user");return this.http.put(o,n)}};t.\u0275fac=function(o){return new(o||t)($e(Vr))},t.\u0275prov=ke({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Y=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},te={searchParams:"URLSearchParams"in Y,iterable:"Symbol"in Y&&"iterator"in Symbol,blob:"FileReader"in Y&&"Blob"in Y&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in Y,arrayBuffer:"ArrayBuffer"in Y};function di(e){return e&&DataView.prototype.isPrototypeOf(e)}te.arrayBuffer&&($r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],zr=ArrayBuffer.isView||function(e){return e&&$r.indexOf(Object.prototype.toString.call(e))>-1});var $r,zr;function De(e){if(typeof e!="string"&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||e==="")throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function Rt(e){return typeof e!="string"&&(e=String(e)),e}function Ut(e){var t={next:function(){var r=e.shift();return{done:r===void 0,value:r}}};return te.iterable&&(t[Symbol.iterator]=function(){return t}),t}function q(e){this.map={},e instanceof q?e.forEach(function(t,r){this.append(r,t)},this):Array.isArray(e)?e.forEach(function(t){if(t.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+t.length);this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}q.prototype.append=function(e,t){e=De(e),t=Rt(t);var r=this.map[e];this.map[e]=r?r+", "+t:t};q.prototype.delete=function(e){delete this.map[De(e)]};q.prototype.get=function(e){return e=De(e),this.has(e)?this.map[e]:null};q.prototype.has=function(e){return this.map.hasOwnProperty(De(e))};q.prototype.set=function(e,t){this.map[De(e)]=Rt(t)};q.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)};q.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),Ut(e)};q.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),Ut(e)};q.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),Ut(e)};te.iterable&&(q.prototype[Symbol.iterator]=q.prototype.entries);function Dt(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function Xr(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function pi(e){var t=new FileReader,r=Xr(t);return t.readAsArrayBuffer(e),r}function hi(e){var t=new FileReader,r=Xr(t),n=/charset=([A-Za-z0-9_-]+)/.exec(e.type),o=n?n[1]:"utf-8";return t.readAsText(e,o),r}function mi(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}function Yr(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function Qr(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?typeof e=="string"?this._bodyText=e:te.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:te.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:te.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():te.arrayBuffer&&te.blob&&di(e)?(this._bodyArrayBuffer=Yr(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):te.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||zr(e))?this._bodyArrayBuffer=Yr(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):te.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},te.blob&&(this.blob=function(){var e=Dt(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=Dt(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(te.blob)return this.blob().then(pi);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var e=Dt(this);if(e)return e;if(this._bodyBlob)return hi(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(mi(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},te.formData&&(this.formData=function(){return this.text().then(wi)}),this.json=function(){return this.text().then(JSON.parse)},this}var gi=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function vi(e){var t=e.toUpperCase();return gi.indexOf(t)>-1?t:e}function Te(e,t){if(!(this instanceof Te))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t=t||{};var r=t.body;if(e instanceof Te){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new q(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!r&&e._bodyInit!=null&&(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",(t.headers||!this.headers)&&(this.headers=new q(t.headers)),this.method=vi(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in Y){var i=new AbortController;return i.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),(this.method==="GET"||this.method==="HEAD")&&(t.cache==="no-store"||t.cache==="no-cache")){var n=/([?&])_=[^&]*/;if(n.test(this.url))this.url=this.url.replace(n,"$1_="+new Date().getTime());else{var o=/\?/;this.url+=(o.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}Te.prototype.clone=function(){return new Te(this,{body:this._bodyInit})};function wi(e){var t=new FormData;return e.trim().split("&").forEach(function(r){if(r){var n=r.split("="),o=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(i))}}),t}function bi(e){var t=new q,r=e.replace(/\r?\n[\t ]+/g," ");return r.split("\r").map(function(n){return n.indexOf("\n")===0?n.substr(1,n.length):n}).forEach(function(n){var o=n.split(":"),i=o.shift().trim();if(i){var a=o.join(":").trim();try{t.append(i,a)}catch(s){console.warn("Response "+s.message)}}}),t}Qr.call(Te.prototype);function pe(e,t){if(!(this instanceof pe))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=t.status===void 0?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText===void 0?"":""+t.statusText,this.headers=new q(t.headers),this.url=t.url||"",this._initBody(e)}Qr.call(pe.prototype);pe.prototype.clone=function(){return new pe(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new q(this.headers),url:this.url})};pe.error=function(){var e=new pe(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var yi=[301,302,303,307,308];pe.redirect=function(e,t){if(yi.indexOf(t)===-1)throw new RangeError("Invalid status code");return new pe(null,{status:t,headers:{location:e}})};var Se=Y.DOMException;try{new Se}catch{Se=function(t,r){this.message=t,this.name=r;var n=Error(t);this.stack=n.stack},Se.prototype=Object.create(Error.prototype),Se.prototype.constructor=Se}function Zr(e,t){return new Promise(function(r,n){var o=new Te(e,t);if(o.signal&&o.signal.aborted)return n(new Se("Aborted","AbortError"));var i=new XMLHttpRequest;function a(){i.abort()}i.onload=function(){var l={statusText:i.statusText,headers:bi(i.getAllResponseHeaders()||"")};o.url.indexOf("file://")===0&&(i.status<200||i.status>599)?l.status=200:l.status=i.status,l.url="responseURL"in i?i.responseURL:l.headers.get("X-Request-URL");var c="response"in i?i.response:i.responseText;setTimeout(function(){r(new pe(c,l))},0)},i.onerror=function(){setTimeout(function(){n(new TypeError("Network request failed"))},0)},i.ontimeout=function(){setTimeout(function(){n(new TypeError("Network request timed out"))},0)},i.onabort=function(){setTimeout(function(){n(new Se("Aborted","AbortError"))},0)};function s(l){try{return l===""&&Y.location.href?Y.location.href:l}catch{return l}}if(i.open(o.method,s(o.url),!0),o.credentials==="include"?i.withCredentials=!0:o.credentials==="omit"&&(i.withCredentials=!1),"responseType"in i&&(te.blob?i.responseType="blob":te.arrayBuffer&&(i.responseType="arraybuffer")),t&&typeof t.headers=="object"&&!(t.headers instanceof q||Y.Headers&&t.headers instanceof Y.Headers)){var u=[];Object.getOwnPropertyNames(t.headers).forEach(function(l){u.push(De(l)),i.setRequestHeader(l,Rt(t.headers[l]))}),o.headers.forEach(function(l,c){u.indexOf(c)===-1&&i.setRequestHeader(c,l)})}else o.headers.forEach(function(l,c){i.setRequestHeader(c,l)});o.signal&&(o.signal.addEventListener("abort",a),i.onreadystatechange=function(){i.readyState===4&&o.signal.removeEventListener("abort",a)}),i.send(typeof o._bodyInit>"u"?null:o._bodyInit)})}Zr.polyfill=!0;Y.fetch||(Y.fetch=Zr,Y.Headers=q,Y.Request=Te,Y.Response=pe);var Ae;(function(e){e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR"})(Ae||(Ae={}));var Ii=function(){function e(t){t===void 0&&(t=Ae.INFO),this.logLevel=t,this._debug=console.debug,this._info=console.info,this._warn=console.warn,this._error=console.error}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.logLevel<=Ae.DEBUG&&(t.unshift("[DEBUG]"),this._debug.apply(this,N([],I(t),!1)))},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.logLevel<=Ae.INFO&&(t.unshift("[INFO]"),this._info.apply(this,N([],I(t),!1)))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.logLevel<=Ae.WARN&&(t.unshift("[WARN]"),this._warn.apply(this,N([],I(t),!1)))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.logLevel<=Ae.ERROR&&(t.unshift("[ERROR]"),this._error.apply(this,N([],I(t),!1)))},e}(),T=new Ii(3);var _i=function(e,t){this._driver=e,this.liff=t,this.hooks=this._driver.hooks,this.internalHooks=this._driver.internalHooks},Ei=function(e,t){this._driver=e,this.liff=t,this.hooks=this._driver.hooks},tn=function(){function e(t,r){this.pluginCtx=new Ei(t,r),this.moduleCtx=new _i(t,r)}return Object.defineProperty(e.prototype,"pluginContext",{get:function(){return this.pluginCtx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"moduleContext",{get:function(){return this.moduleCtx},enumerable:!1,configurable:!0}),e}(),rn=function(){function e(){this.modules=new Map,this.hooks={},this.internalHooks={}}return e.prototype.addModule=function(t,r){this.modules.set(t,r),r.hooks&&(this.hooks[t]=Object.entries(r.hooks).reduce(function(n,o){var i,a=I(o,2),s=a[0],u=a[1];return M(M({},n),((i={})[s]=u.on.bind(u),i))},{})),"internalHooks"in r&&r.internalHooks&&(this.internalHooks[t]=Object.entries(r.internalHooks).reduce(function(n,o){var i,a=I(o,2),s=a[0],u=a[1];return M(M({},n),((i={})[s]=u.on.bind(u),i))},{}))},e.prototype.hasModule=function(t){return this.modules.has(t)},e}(),v=function(){},en=function(e){return e instanceof v},Ft=function(e){function t(r,n,o){var i=e.call(this)||this;return i.driver=r,i.contextHolder=n,i.option=o,i}return g(t,e),t.prototype.install=function(){return this.factory(this.driver,this.contextHolder)},Object.defineProperty(t.prototype,"name",{get:function(){return"use"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultOption",{get:function(){return{namespacePrefix:"$"}},enumerable:!1,configurable:!0}),t.prototype.factory=function(r,n){var o=Object.assign({},this.defaultOption,this.option).namespacePrefix;return function(i,a){if(!i||typeof i.install!="function"||typeof i.name!="string")return T.warn("To install the plugin, you need to define the `name` property and the `install` method."),this;var s=en(i)?i.name:"".concat(o).concat(i.name);if(r.hasModule(s))return this;var u=en(i)?i.install.call(i,n.moduleContext,a):i.install.call(i,n.pluginContext,a);return this["".concat(s)]?(T.warn("There is a duplicate plugin name. `".concat(s,"` plugin namespace will be override.")),this["".concat(s)]=u):u!==void 0&&(this["".concat(s)]=u),r.addModule(s,i),this}},t}(v);var Bt,nn=new Promise(function(e){Bt=e});var W="UNKNOWN",B="UNAUTHORIZED",L="INVALID_ARGUMENT",U="INIT_FAILED",C="FORBIDDEN",z="INVALID_CONFIG",be="INVALID_ID_TOKEN";var Ye="CREATE_SUBWINDOW_FAILED",ze="EXCEPTION_IN_SUBWINDOW",Wt="liffEvent",re="LIFF_STORE",Re="https://liff.".concat("line.me","/"),Xe="https://miniapp.".concat("line.me","/"),O={ACCESS_TOKEN:"accessToken",ID_TOKEN:"IDToken",DECODED_ID_TOKEN:"decodedIDToken",FEATURE_TOKEN:"featureToken",LOGIN_TMP:"loginTmp",CONFIG:"config",CONTEXT:"context",EXPIRES:"expires",RAW_CONTEXT:"rawContext",CLIENT_ID:"clientId",IS_SUBSEQUENT_LIFF_APP:"isSubsequentLiffApp",MST_CHALLENGE:"mstChallenge",MSIT:"msit",MST:"mst",MST_VERIFIER:"mstVerifier",APP_DATA:"appData"},jt="isInClient",Qe=["context_token","feature_token","access_token","id_token","client_id","mst_verifier","mst_challenge","msit"],on=5,an=["liff.ref.source","liff.ref.medium","liff.ref.campaign","liff.ref.term","liff.ref.content"],sn="liff://subwindow",x={INIT:"init",SUBMIT:"submit",CANCEL:"cancel",CLOSE:"close",ERROR:"error"},un=100,Ht=100,dt="liff.subwindow",Ue="healthCheck";var cn=["profile","chat_message.write","openid","email"];function ln(e){return window.atob(e.replace(/-/g,"+").replace(/_/g,"/"))}var pt={decode:ln,encode:function(e){return window.btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},decodeUnicode:function(e){var t=ln(e).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("");return decodeURIComponent(t)}};function G(e,t){if(e===t)return 0;for(var r=e.split("."),n=t.split("."),o=Math.max(r.length,n.length),i=0;i<o;i++){r[i]||(r[i]="0"),n[i]||(n[i]="0");var a=parseInt(r[i])-parseInt(n[i]);if(a!==0)return a>0?1:-1}return 0}function Gt(e){var t=e.replace("#","").match(/.{2}/g)||[];if(t.length!==4)return T.warn("convertArgbToRgba: Received invalid ARGB color"),"";var r=function(a){var s=Ce(a);return Math.round(s/255*100)/100}(t[0]),n=Ce(t[1]),o=Ce(t[2]),i=Ce(t[3]);return"rgba(".concat(n,", ").concat(o,", ").concat(i,", ").concat(r,")")}function Ce(e){return parseInt(e,16)}function Kt(e){var t=e.replace("#","").match(/.{2}/g)||[];if(t.length!==3)return T.warn("convertArgbToRgba: Received invalid hex color"),"";var r=Ce(t[0]),n=Ce(t[1]),o=Ce(t[2]);return"".concat(r,", ").concat(n,", ").concat(o)}function qt(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;o<t;o++)n[o]=e.charCodeAt(o);return r}var ht={get:function(e){var t=new RegExp("(?:(?:^|.*;\\s*)".concat(e,"\\s*\\=\\s*([^;]*).*$)|^.*$"));return document.cookie.replace(t,"$1")},set:function(e,t,r){var n=e+"="+t;if(r)for(var o in r){var i=r[o]?"=".concat(r[o]):"";n+="; ".concat(o).concat(i)}T.debug("set cookie",n),document.cookie=n},remove:function(e,t){var r="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 GMT");if(t)for(var n in t)r+="; ".concat(n,"=").concat(t[n]);document.cookie=r}},mn=new Set(["400","401","403","404","429","500"]),Jt=function(e){function t(r,n,o){var i=e.call(this,n,o)||this;return i.code=r,i}return g(t,e),t}(Error);function f(e,t,r){return r!=null&&r.cause&&console.error("This is the cause of LiffError described below.",r.cause),new Jt(e,t||"",r||{})}function Ze(e){var t=e.match(/([^-]+)-[^-]+/);return t&&t[1]}function gn(e){var t="";return e.replace(/\r|\n/g,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ").forEach(function(r){t+=String.fromCharCode(parseInt(r))}),window.btoa(t)}var $t=function(){function e(){this.map={}}return e.prototype.clear=function(){this.map={}},e.prototype.getItem=function(t){var r=this.map[t];return r===void 0?null:r},e.prototype.setItem=function(t,r){this.map[t]=r},e.prototype.removeItem=function(t){delete this.map[t]},e.prototype.key=function(t){var r=Object.keys(this.map)[t];return r===void 0?null:r},Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.map).length},enumerable:!1,configurable:!0}),e}(),Vt,j={parse:function(e){return e.replace(/^\?/,"").replace(/^#\/?/,"").split(/&+/).filter(function(t){return t.length>0}).reduce(function(t,r){var n=I(r.split("=").map(decodeURIComponent),2),o=n[0],i=n[1],a=t[o];return Array.isArray(a)?a.push(i):Object.prototype.hasOwnProperty.call(t,o)?t[o]=[a,i]:t[o]=i,t},{})},stringify:function(e){return Object.keys(e).map(function(t){var r=e[t],n=function(o){return o!==void 0?"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(o)):encodeURIComponent(t)};return Array.isArray(r)?r.map(function(o){return n(o)}).join("&"):n(r)}).join("&")}},fn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Si(){return window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967296}function he(e){for(var t="",r=0;r<e;r++)t+=fn[Math.floor(Si()*fn.length)];return t}function Yt(e){var t=new URL(e),r=t.hash.slice(1).split("&").filter(function(n){return!Qe.some(function(o){return n.startsWith("".concat(o,"="))})}).join("&");return t.hash=r,t.toString()}function Ti(e){var t=new URL(e);return t.toString().replace(new RegExp(String.raw(dn||(dn=jr(["^",""],["^",""])),t.origin)),"")}var vn=function(e){var t=Yt(e);if(t!==e){var r=Ti(t);window.history.replaceState(history.state,"",r)}};function Fe(e,t){if(!e)throw new Error("addParamsToUrl: invalid URL");var r=new URL(e);return Object.entries(t).forEach(function(n){var o=I(n,2),i=o[0],a=o[1];r.searchParams.set(i,a)}),r.toString()}var dn,pn=((Vt={})[Re]=function(){var e=hn(Re);return new RegExp("^".concat(e,"(\\d+-\\w+)"))},Vt[Xe]=function(){var e=hn(Xe);return new RegExp("^".concat(e,"((\\d+-\\w+)|(\\w+$))"))},Vt);function et(e){for(var t in pn){var r=e.match(pn[t]());if(r)return r[1]}return null}function hn(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function wn(e){var t=e.match(/^(https?:\/\/.*?)\//);return t&&t[1]||""}function mt(e){return e.startsWith("line:")}function Be(e){return e===void 0&&(e=window.navigator.userAgent),/ipad/.test(e.toLowerCase())}function gt(e){return e===void 0&&(e=window.navigator.userAgent),/Line\/\d+\.\d+\.\d+/.test(e)}function vt(e){return e===void 0&&(e=window.navigator.userAgent),/Line\/\d+\.\d+\.\d+ LIFF/.test(e)}function bn(e){return e===void 0&&(e=window.navigator.userAgent),/LIFF\/SubWindow/.test(e)}var wt=function(){return typeof window>"u"};var bt=null;function S(){return bt===null&&(bt=vt()||gt()&&/[#|&]access_token=/.test(location.hash)||sessionStorage.getItem("".concat(re,":").concat(jt))==="1",sessionStorage.setItem("".concat(re,":").concat(jt),bt?"1":"0")),!!bt}var ws=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"isInClient"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return S()}},t}(v);function P(){var e;return(e=window.__liffConfig)!==null&&e!==void 0?e:{}}function yn(e){window.__liffConfig=e}function Ai(e,t){if(!t)throw f(z,"liffId is necessary for liff.init()");var r=(S()?sessionStorage:localStorage).getItem("".concat(re,":").concat(t,":").concat(e));try{return r===null?null:JSON.parse(r)}catch{return null}}function ie(e){return Ai(e,P().liffId)}function se(e,t){var r=P().liffId;if(!r)throw f(z,"liffId is necessary for liff.init()");(S()?sessionStorage:localStorage).setItem("".concat(re,":").concat(r,":").concat(e),JSON.stringify(t))}function F(){return ie(O.CONTEXT)}function yt(e){se(O.CONTEXT,e)}var Ts=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getContext"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return F()}},t}(v);function zt(){return((F()||{}).d||{}).aId}var As=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getAId"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return zt()}},t}(v);function Xt(){return((F()||{}).d||{}).autoplay||!1}var Cs=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getIsVideoAutoPlay"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return Xt()}},t}(v);function Qt(){return(F()||{}).profilePlus}var Ls=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getProfilePlus"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return Qt()}},t}(v);function In(){return!!ie(O.IS_SUBSEQUENT_LIFF_APP)}function _n(e){se(O.IS_SUBSEQUENT_LIFF_APP,e)}function En(){return ie(O.APP_DATA)}function It(e){se(O.APP_DATA,e)}function Sn(){return ie(O.MST_VERIFIER)}function Tn(e){se(O.MST_VERIFIER,e)}function An(){return ie(O.MSIT)}function Cn(e){se(O.MSIT,e)}function We(){return ie(O.MST)}function Ln(e){se(O.MST,e)}function _t(){return ie(O.MST_CHALLENGE)}function On(e){se(O.MST_CHALLENGE,e)}function Nn(){return ie(O.CLIENT_ID)}function Zt(e){se(O.CLIENT_ID,e)}function Pn(){return ie(O.RAW_CONTEXT)}function Le(){return ie(O.FEATURE_TOKEN)}function er(e){se(O.FEATURE_TOKEN,e)}function je(){return ie(O.ID_TOKEN)}function tr(e){se(O.ID_TOKEN,e)}var Os=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getIDToken"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return je()}},t}(v);function ne(){return ie(O.ACCESS_TOKEN)}function tt(e){se(O.ACCESS_TOKEN,e)}var Ns=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getAccessToken"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return ne()}},t}(v);function xn(e){var t=P().liffId;if(!t)throw f(z,"liffId is necessary for liff.init()");(S()?sessionStorage:localStorage).removeItem("".concat(re,":").concat(t,":").concat(e))}function rr(){return ie(O.LOGIN_TMP)}function kn(e){se(O.LOGIN_TMP,e)}function nr(){xn(O.LOGIN_TMP)}function or(e){var t=P();ht.set("".concat(re,":").concat(O.EXPIRES,":").concat(t.liffId),e.getTime(),{expires:e.toUTCString(),path:"/",secure:null})}function Mn(){var e=P();return ht.get("".concat(re,":").concat(O.EXPIRES,":").concat(e.liffId))}function Ci(){var e=P();ht.remove("".concat(re,":").concat(O.EXPIRES,":").concat(e.liffId),{path:"/"})}function Oe(){return ie(O.DECODED_ID_TOKEN)}function ir(e){se(O.DECODED_ID_TOKEN,e)}var Ps=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getDecodedIDToken"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return Oe()}},t}(v);function Dn(){Object.keys(O).forEach(function(e){xn(O[e])}),Ci()}function H(){return!!ne()}var Rs=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"isLoggedIn"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return H()}},t}(v);function ye(){return"2.27.1"}var Ws=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getVersion"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return"2.27.1"}},t}(v);var Li=function(){function e(){}return e.prototype.invoke=function(){return bn()},e}(),Oi=function(){function e(t){this.storage=t}return Object.defineProperty(e,"IN_SUB_WINDOW_KEY",{get:function(){return"inSubWindow"},enumerable:!1,configurable:!0}),e.prototype.invoke=function(){return new URLSearchParams(window.location.search).has(dt)&&this.setInSubWindow(!0),!(!this.getInSubWindow()&&!this.getSubWindowIdentifier())},e.prototype.getInSubWindow=function(){var t=this.storage.getItem("".concat(re,":").concat(this.getLiffId(),":").concat(e.IN_SUB_WINDOW_KEY));return t!==null&&JSON.parse(t)},e.prototype.getSubWindowIdentifier=function(){var t,r,n="liff.subwindow.identifier",o=new URLSearchParams(window.location.search);return o.get(n)||(t=n,(r=o.get("liff.state"))?new URLSearchParams(r).get(t):null)||null},e.prototype.setInSubWindow=function(t){this.storage.setItem("".concat(re,":").concat(this.getLiffId(),":").concat(e.IN_SUB_WINDOW_KEY),String(t))},e.prototype.getLiffId=function(){var t=P().liffId;if(!t)throw f(z,"liffId is necessary for liff.init()");return t},e}(),Ni=function(e){function t(){var r=e.call(this)||this;return wt()?r.impl={invoke:function(){return!1}}:S()?r.impl=new Li:r.impl=new Oi(window.sessionStorage),r}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"isSubWindow"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return this.impl.invoke.bind(this.impl)},t}(v),ar=new Ni,ae=ar.install();function J(){var e=navigator.userAgent.match(/Line\/\d+(\.\d+)*/i);return e?e[0].slice(5):null}var Xs=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getLineVersion"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return J()}},t}(v);var sr;function R(){if(!sr){var e=window.navigator.userAgent.toLowerCase();sr=/iphone|ipad|ipod/.test(e)?"ios":/android/.test(e)?"android":"web"}return sr}var tu=function(e){function t(){return e.call(this)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getOS"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return R()}},t}(v);function Un(e){var t,r=F();return(t=r==null?void 0:r.availability)===null||t===void 0?void 0:t[e]}function le(e,t,r){var n=Un(e),o=r||e;if(!n)return{available:!1,error:{code:C,message:"".concat(o," is not allowed in this LIFF app")}};var i=n.minVer,a=n.unsupportedFromVer,s=!i||function(l,c){var m=J();return!!m&&!(c&&G(m,c)>0)&&G(m,l)>=0}(i,a),u=S();return u&&!s?{available:!1,error:{code:C,message:"".concat(o," is unavailable in this client version.")}}:n.permission?u&&s||t?{available:!0}:{available:!1,error:{code:C,message:"".concat(o," is not allowed in external browser")}}:{available:!1,error:{code:C,message:"".concat(o," is not allowed in this LIFF app")}}}var Rn=function(){return H()?!vt()&&gt()?{available:!1,error:{code:C,message:"Subwindow is not supported in this browser"}}:ae()?{available:!1,error:{code:C,message:"this api can be only called in parent window"}}:le("subwindowOpen",!0):{available:!1,error:{code:B,message:"Need access_token for api call, Please login first"}}},Pi=["subwindowOpen","shareTargetPicker","multipleLiffTransition","scanCode","scanCodeV2","getAdvertisingId","addToHomeScreen","bluetoothLeFunction","skipChannelVerificationScreen","createShortcutOnHomeScreen","internalCreateShortcutOnHomeScreen","iap"],ue={scanCode:function(){return le("scanCode")},getAdvertisingId:function(){return le("getAdvertisingId")},bluetoothLeFunction:function(){return le("bluetoothLeFunction")},shareTargetPicker:function(){return ae()?{available:!1,error:{code:C,message:"this api can be only called in parent window"}}:H()?le("shareTargetPicker",!0):{available:!1,error:{code:B,message:"Need access_token for api call, Please login first"}}},multipleLiffTransition:function(){var e=Un("multipleLiffTransition");return e&&e.permission?S()?{available:!0}:{available:!1,error:{code:C,message:"multipleLiffTransition is available only in the LINE App browser"}}:{available:!1,error:{code:C,message:"multipleLiffTransition is not allowed in this LIFF app"}}},subwindowOpen:Rn,scanCodeV2:function(){if(!H())return{available:!1,error:{code:B,message:"Need access_token for api call, Please login first"}};var e=Rn();return e.available?le("scanCodeV2",!0):e},addToHomeScreen:function(){return ae()?{available:!1,error:{code:C,message:"this api can be only called in parent window"}}:le("addToHomeScreen")},skipChannelVerificationScreen:function(){var e=F();return e?e.type==="square_chat"?{available:!1,error:{code:C,message:"skipChannelVerificationScreen is not allowed in OpenChat"}}:le("skipChannelVerificationScreen"):{available:!1,error:{code:C,message:"Context is not found"}}},createShortcutOnHomeScreen:function(){if(ae())return{available:!1,error:{code:C,message:"this api can be only called in parent window"}};if(!H())return{available:!1,error:{code:B,message:"Need access_token for api call, Please login first"}};var e=R();return e!=="android"&&e!=="ios"?{available:!1,error:{code:C,message:"this api can be only called in mobile device"}}:le("addToHomeV2",!0,"createShortcutOnHomeScreen")},internalCreateShortcutOnHomeScreen:function(){if(ae())return{available:!1,error:{code:C,message:"this api can be only called in parent window"}};if(!H())return{available:!1,error:{code:B,message:"Need access_token for api call, Please login first"}};var e=R();if(e!=="android"&&e!=="ios")return{available:!1,error:{code:C,message:"this api can be only called in mobile device"}};var t=le("addToHomeV2",!0,"internalCreateShortcutOnHomeScreen");return t.available?le("addToHomeLineScheme",!0,"internalCreateShortcutOnHomeScreen"):t},iap:function(){return S()?H()?ae()?{available:!1,error:{code:C,message:"this api can be only called in parent window"}}:le("iap",!1,"In-App Purchase"):{available:!1,error:{code:B,message:"Need access_token for api call, Please login first"}}:{available:!1,error:{code:C,message:"In-App Purchase is not allowed in external browser"}}}},ce=function(e){return function(){var t=e();if(!t.available)throw f(t.error.code,t.error.message)}},oe={scanCode:ce(ue.scanCode),getAdvertisingId:ce(ue.getAdvertisingId),bluetoothLeFunction:ce(ue.bluetoothLeFunction),shareTargetPicker:ce(ue.shareTargetPicker),multipleLiffTransition:ce(ue.multipleLiffTransition),subwindowOpen:ce(ue.subwindowOpen),scanCodeV2:ce(ue.scanCodeV2),addToHomeScreen:ce(ue.addToHomeScreen),skipChannelVerificationScreen:ce(ue.skipChannelVerificationScreen),createShortcutOnHomeScreen:ce(ue.createShortcutOnHomeScreen),internalCreateShortcutOnHomeScreen:ce(ue.internalCreateShortcutOnHomeScreen),iap:ce(ue.iap)};function Ie(e){if(!function(r){return Pi.some(function(n){return n===r})}(e))throw f(L,"Unexpected API name.");var t=ue[e];return!t||t().available}var pu=function(e){function t(){var r=e.apply(this,N([],I(arguments),!1))||this;return r.hooks={},r}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"isApiAvailable"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(r){return Ie(r)}},t}(v);var xi=function(){function e(){}return e.prototype.invoke=function(t){var r=oe[t];return!!r&&(r(),!0)},e}(),ki=function(){function e(t){this.liff=t}return e.prototype.invoke=function(t){return this.liff.checkFeature(t)},e}(),Et=function(){function e(t){G(ye(),e.SDK_VERSION_SUPPORTING_NEW)>=0?this.impl=new xi:this.impl=new ki(t)}return Object.defineProperty(e,"SDK_VERSION_SUPPORTING_NEW",{get:function(){return"2.11.0"},enumerable:!1,configurable:!0}),e.prototype.invoke=function(t){return this.impl.invoke(t)},e}();var ur=function(e,t){return ur=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},ur(e,t)};function Mi(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(l){try{u(n.next(l))}catch(c){i(c)}}function s(l){try{u(n.throw(l))}catch(c){i(c)}}function u(l){var c;l.done?o(l.value):(c=l.value,c instanceof r?c:new r(function(m){m(c)})).then(a,s)}u((n=n.apply(e,t||[])).next())})}function Di(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,n=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!((o=o.length>0&&o[o.length-1])||c[0]!==6&&c[0]!==2)){a=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(c[0]===6&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(m){c=[6,m],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var Fn=!1,Ri=function(){return Fn},Bn=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return function(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=r}ur(r,n),r.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"_legacyExtensionsEnabled"},enumerable:!1,configurable:!0}),t.prototype.install=function(){Fn=!0},t}(v);function Ui(){var e;return R()==="ios"?(e=J())&&G(e,"9.19.0")<0?"https://static.line-scdn.net/liff/edge/2/ios-918-extensions_2_22_0.js":"https://static.line-scdn.net/liff/edge/2/ios-extensions_2_22_0.js":"https://static.line-scdn.net/liff/edge/2/non-ios-extensions_2_22_0.js"}function Wn(){return Ri()?function(){return Mi(this,void 0,void 0,function(){return Di(this,function(e){switch(e.label){case 0:return[3,2];case 1:return[2,e.sent().default];case 2:return[2,new Promise(function(t,r){var n=document.createElement("script"),o=Ui();n.onload=function(){var i=window.liffClientExtension;i?t(i):r(f(U,"Unable to load client features. (Extension is empty)"))},n.onerror=function(i){r(f(U,"Unable to load client features.",{cause:i}))},n.src=o,n.type="text/javascript",document.body.appendChild(n)})]}})})}():Promise.resolve(void 0)}function rt(){Dn()}var Lu=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"logout"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return rt()}},t}(v);function Fi(e){return d(this,void 0,void 0,function(){var t,r,n;return p(this,function(o){switch(o.label){case 0:if(!e.ok)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e.json()];case 2:return[2,o.sent()];case 3:return o.sent(),[2,e];case 4:return t=String(e.status),r=mn.has(t)?t:W,[4,e.json().catch(function(){throw f(r,e.statusText)})];case 5:throw n=o.sent(),f(n.error||r,n.error_description||n.message)}})})}function jn(e){var t=function(r){if(r)return r;var n=ne();if(!n)throw f(B,"Need access_token for api call, Please login first");return{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(n)}}(e&&e.headers);return M(M({},e),{headers:t})}function D(e,t){var r;try{r=jn(t)}catch(n){return Promise.reject(n)}return fetch(e,r).then(Fi)}function Hn(e,t){var r;try{r=jn(t)}catch(n){return Promise.reject(n)}return fetch(e,r)}function V(e){var t=e.subdomain,r=t===void 0?"api":t,n=e.pathname;return"https://".concat(r,".").concat("line.me","/").concat(n)}var Bi={token:V({pathname:"oauth2/v2.1/token"}),certs:V({pathname:"oauth2/v2.1/certs"}),"openid-configuration":V({subdomain:"access",pathname:".well-known/openid-configuration"}),authorize:V({subdomain:"access",pathname:"liff/v1/authorize"}),profile:V({pathname:"v2/profile"}),message:V({pathname:"message/v3/share"}),friendship:V({pathname:"friendship/v1/status"}),shareTargetPicker:V({subdomain:"access",pathname:"oauth2/v2.1/liff/shareTargetPicker"}),shareTargetPickerOtt:V({pathname:"liff/v2/apps"}),shareTargetPickerResult:V({subdomain:"access",pathname:"oauth2/v2.1/liff/shareTargetPicker/result"}),apps:V({pathname:"liff/v2/apps"}),subWindowGetMSIT:V({pathname:"liff/v2/sub/msit"}),subWindowGetMSTByMSIT:V({pathname:"liff/v2/sub/mst"}),subWindowSubscribe:V({subdomain:"liff",pathname:"liff/v2/sub/waitResult"}),subWindowPost:V({pathname:"liff/v2/sub/result"}),subWindowGetAppData:V({pathname:"liff/v2/sub/appData"}),subWindowGetOrigin:function(e){return V({pathname:"liff/v2/sub/".concat(e,"/origin")})},accessTokenVerify:V({pathname:"oauth2/v2.1/verify"}),unauthorizedPermissions:V({subdomain:"liff",pathname:"liff/v2/incrementalAgreement/unauthorizedPermissions"}),permanentLink:V({subdomain:"liff",pathname:"liff/v2/permanentLink"}),createShortcutOnHomeScreen:V({subdomain:"liff-shortcut",pathname:"api/shortcut"})};function k(e){return Bi[e]}function nt(e){return D("".concat(k("accessTokenVerify"),"?access_token=").concat(encodeURIComponent(e)),{headers:{"Content-Type":"application/json",Accept:"application/json"}})}var At="liff.subwindow.identifier",St="liff.subwindow.cryptokey",ot=M(M({},x),{GET_DATA:"getData",SET_DATA:"setData",NOT_FOUND:"notFound",TEARDOWN:"teardown"}),Tt={BROADCAST:"broadcast",COMMAND:"command"},Ne={MAIN:"main",SUB:"sub"};var Vn=function(e){return d(void 0,void 0,void 0,function(){var t;return p(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,window.crypto.subtle.importKey("jwk",{kty:"oct",k:e,alg:"A128GCM",ext:!0},{name:"AES-GCM"},!1,["encrypt","decrypt"])];case 1:return[2,r.sent()];case 2:throw t=r.sent(),f(W,t);case 3:return[2]}})})},Wi=function(e,t,r){return d(void 0,void 0,void 0,function(){var n,o,i,a;return p(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),n=new TextEncoder().encode(e),[4,Vn(t)];case 1:return o=s.sent(),[4,window.crypto.subtle.encrypt({name:"AES-GCM",iv:n},o,new TextEncoder().encode(r))];case 2:return i=s.sent(),[2,btoa(new Uint8Array(i).reduce(function(u,l){return u+String.fromCharCode(l)},""))];case 3:throw a=s.sent(),f(W,a);case 4:return[2]}})})},ji=function(e,t,r){return d(void 0,void 0,void 0,function(){var n,o,i,a,s,u,l;return p(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),n=new TextEncoder().encode(e),[4,Vn(t)];case 1:for(o=c.sent(),i=atob(r),a=new Uint8Array(i.length),s=0;s<i.length;s++)a[s]=i.charCodeAt(s);return[4,window.crypto.subtle.decrypt({name:"AES-GCM",iv:n},o,a.buffer)];case 2:return u=c.sent(),[2,new TextDecoder().decode(new Uint8Array(u))];case 3:throw l=c.sent(),f(W,l);case 4:return[2]}})})},Hi=function(e,t){return it(e)===it(t)},it=function(e){return"".concat(e.identifier,"-").concat(e.action,"-").concat(e.timestamp)},Vi=function(e){return Object.keys(x).map(function(t){return x[t]}).includes(e)?Tt.BROADCAST:Tt.COMMAND};function Gi(){var e=document.createElement("form");e.method="POST",e.action="$MESSAGE_HANDLER_URL";var t=document.createElement("input");t.type="hidden",t.name="identifier",t.value="$IDENTIFIER",e.appendChild(t),document.body.appendChild(e),e.submit()}var Gn=function(e){e===void 0&&(e=Ne.MAIN);var t=this;this.identification={identifier:"",cryptoKey:""},this.messageHandlerInstance=null,this.listeners=new Map,this.sentMessages=[],this.generateIdentification=function(){return d(t,void 0,void 0,function(){var r,n,o,i,a;return p(this,function(s){switch(s.label){case 0:return r=new URLSearchParams(window.location.search),n=function(u){var l=r.get("liff.state");return l?new URLSearchParams(l).get(u):null},o=this,a={identifier:this.windowType===Ne.MAIN?he(12):r.get("liff.subwindow.identifier")||n("liff.subwindow.identifier")||""},this.windowType!==Ne.MAIN?[3,2]:[4,d(void 0,void 0,void 0,function(){var u,l,c;return p(this,function(m){switch(m.label){case 0:return m.trys.push([0,3,,4]),[4,window.crypto.subtle.generateKey({name:"AES-GCM",length:128},!0,["encrypt","decrypt"])];case 1:return u=m.sent(),[4,window.crypto.subtle.exportKey("jwk",u)];case 2:if(!(l=m.sent())||!l.k)throw f(W,"failed to generate key");return[2,l.k];case 3:throw c=m.sent(),f(W,c);case 4:return[2]}})})];case 1:return i=s.sent(),[3,3];case 2:i=r.get(St)||n(St)||"",s.label=3;case 3:return o.identification=(a.cryptoKey=i,a),[2]}})})},this.hasIdentification=function(){var r=t.identification,n=r.identifier,o=r.cryptoKey;return typeof n=="string"&&typeof o=="string"&&n.length>0&&o.length>0},this.isReady=function(){return t.hasIdentification()&&!!t.messageHandlerInstance},this.setup=function(){return d(t,void 0,void 0,function(){var r,n,o,i,a,s=this;return p(this,function(u){switch(u.label){case 0:return this.messageHandlerInstance?[2]:[4,this.generateIdentification()];case 1:if(u.sent(),!(r=this.identification.identifier))return[2];if(n=/^[a-zA-Z0-9]+$/gm,!r.match(n))throw f(W,"Invalid identifier");return(o=document.createElement("iframe")).style.display="none",o.src="about:blank",document.body.appendChild(o),(a=o==null?void 0:o.contentWindow)===null||a===void 0||a.window.eval("(".concat(Gi.toString().replace("$MESSAGE_HANDLER_URL","".concat("https://liff-subwindow.line.me/liff/v2/sub/messageHandler")).replace("$IDENTIFIER",r.split("'")[0]),")()")),i="iframe-".concat(r,"-ready"),[4,new Promise(function(l){var c=function(m){m.data[i]&&(s.messageHandlerInstance=o,window.addEventListener("message",s.proxyToListeners),l(),document.removeEventListener("message",c))};window.addEventListener("message",c)})];case 2:return[2,u.sent()]}})})},this.teardown=function(){return d(t,void 0,void 0,function(){var r,n;return p(this,function(o){switch(o.label){case 0:return this.isReady()?[4,this.send({eventName:ot.TEARDOWN})]:[3,2];case 1:o.sent(),window.removeEventListener("message",this.proxyToListeners),this.listeners.clear(),(n=(r=this.messageHandlerInstance)===null||r===void 0?void 0:r.parentNode)===null||n===void 0||n.removeChild(this.messageHandlerInstance),this.messageHandlerInstance=null,o.label=2;case 2:return[2]}})})},this.listen=function(r){t.listeners.set(r,r)},this.listenRepliedEvent=function(r,n){var o=function(i){i.replyTarget&&Hi(i.replyTarget,r)&&(n(i),t.listeners.delete(o))};t.listeners.set(o,o)},this.send=function(r){return d(t,void 0,void 0,function(){var n,o,i,a,s=this;return p(this,function(u){switch(u.label){case 0:if(!this.isReady())throw f("message bus is not ready to send message");return o={action:Vi(r.eventName),identifier:this.identification.identifier||"",timestamp:new Date().getTime()},[4,this.getEncryptedContext(r)];case 1:return o.context=u.sent(),n=o,(a=(i=this.messageHandlerInstance)===null||i===void 0?void 0:i.contentWindow)===null||a===void 0||a.postMessage({messageBusEvent:n},"*"),this.sentMessages.push(it(n)),[4,new Promise(function(l){s.listenRepliedEvent(n,function(c){l(c.context)})})];case 2:return[2,u.sent()]}})})},this.reply=function(r,n){return d(t,void 0,void 0,function(){var o,i,a,s;return p(this,function(u){switch(u.label){case 0:if(!this.isReady())throw f("message bus is not ready to send message");if(!r.identifier||!r.timestamp)throw f(W,"target message is not valid");return i={action:Tt.BROADCAST},[4,this.getEncryptedContext(n)];case 1:return i.context=u.sent(),i.identifier=this.identification.identifier||"",i.timestamp=new Date().getTime(),i.replyTarget={action:r.action,identifier:r.identifier,timestamp:r.timestamp},o=i,(s=(a=this.messageHandlerInstance)===null||a===void 0?void 0:a.contentWindow)===null||s===void 0||s.postMessage({messageBusEvent:o},"*"),this.sentMessages.push(it(o)),[2]}})})},this.setData=function(r,n){r===void 0&&(r="appData"),t.send({eventName:ot.SET_DATA,key:r,data:n})},this.getData=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return d(t,N([],I(r),!1),void 0,function(o){return o===void 0&&(o="appData"),p(this,function(i){switch(i.label){case 0:return[4,this.send({eventName:ot.GET_DATA,key:o})];case 1:return[2,i.sent()]}})})},this.proxyToListeners=function(r){return d(t,void 0,void 0,function(){var n,o=this;return p(this,function(i){return n=r.data.messageBusEvent,r.origin!=="https://liff-subwindow.line.me"?[2]:n?(this.sentMessages.includes(it(n))||n.identifier!==this.identification.identifier||n.action!==Tt.BROADCAST&&!n.replyTarget||this.listeners.forEach(function(a){return d(o,void 0,void 0,function(){var s,u,l;return p(this,function(c){switch(c.label){case 0:return s=a,u=[M({},n)],l={},[4,this.getDecryptedContext(n.context)];case 1:return s.apply(void 0,[M.apply(void 0,u.concat([(l.context=c.sent(),l)]))]),[2]}})})}),[2]):[2]})})},this.getEncryptedContext=function(r){return d(t,void 0,void 0,function(){var n,o,i,a,s,u,l;return p(this,function(c){switch(c.label){case 0:return n=this.identification,o=n.identifier,i=n.cryptoKey,s=(a=JSON).stringify,l={eventName:r.eventName,key:r.key?r.key:void 0},r.data?[4,Wi(o,i,JSON.stringify(r.data))]:[3,2];case 1:return u=c.sent(),[3,3];case 2:u=void 0,c.label=3;case 3:return[2,s.apply(a,[(l.data=u,l)])]}})})},this.getDecryptedContext=function(r){return d(t,void 0,void 0,function(){var n,o,i,a,s,u,l,c;return p(this,function(m){switch(m.label){case 0:return n=this.identification,o=n.identifier,i=n.cryptoKey,(a=JSON.parse(r)).data&&typeof a.data=="string"?(c=(l=JSON).parse,[4,ji(o,i,a.data)]):[3,2];case 1:return u=c.apply(l,[m.sent()]),[3,3];case 2:u=void 0,m.label=3;case 3:return s=u,[2,M(M({},a),{data:s})]}})})},this.windowType=e};function Ki(e){return new CustomEvent(Wt,{detail:e})}(function(){if(typeof window<"u"&&typeof window.CustomEvent!="function"){let t=function(r,n){var o=n||{},i=o.bubbles,a=i!==void 0&&i,s=o.cancelable,u=s!==void 0&&s,l=o.detail,c=l===void 0?void 0:l,m=document.createEvent("CustomEvent");return m.initCustomEvent(r,a,u,c),m};var e=t;t.prototype=Event.prototype,window.CustomEvent=t}})();var He={},Kn=!1;function at(e,t){Kn||(Kn=!0,window.addEventListener(Wt,function(r){r&&r.detail&&r.detail.type&&He[r.detail.type]&&He[r.detail.type].forEach(function(n){return n(r)})})),He[e]?He[e].push(t):He[e]=[t]}function st(e,t){var r=He[e];if(r&&Array.isArray(r)){var n=r.indexOf(t);n>=0&&r.splice(n,1)}}function qn(e){var t={};try{t=JSON.parse(e)}catch(n){throw f(L,n.message)}var r=Ki(t);T.debug("[client dispatchEvent to js]",{type:r.type,detail:r.detail}),window.dispatchEvent(r)}function cr(e,t,r){t===void 0&&(t={}),r===void 0&&(r="");var n=Le();if(!n)throw f(C,"Invalid featureToken for client features");if(!window._liff||!window._liff.postMessage)throw f(L,"postMessage is not available from client");T.debug("[js postMessage to client]",e,r,t),window._liff.postMessage(e,n,r,JSON.stringify(t))}function me(e,t,r){return t===void 0&&(t={}),r===void 0&&(r={once:!0}),Le()?(r=M({callbackId:he(12),once:!0},r),new Promise(function(n,o){var i=function(a){if(a&&a.detail){var s=a.detail.callbackId===r.callbackId,u=typeof a.detail.callbackId!="string";(s||u)&&(r.once&&st(e,i),T.debug("[callback detail]",a.detail),a.detail.error?o(a.detail.error):a.detail.data?n(a.detail.data):o(a.detail))}o()};at(e,i),cr(e,t,r.callbackId)})):Promise.reject(f(C,"Invalid featureToken for client features"))}function we(){var e=J();e!==null&&(R()==="ios"&&G(e,"9.19")>=0||R()==="android"&&G(e,"11.6.0")>=0)?location.href="liff://close":window._liff&&window._liff.postMessage?e!==null&&G(e,"10.15.0")>=0?R()==="ios"?window._liff.postMessage("closeWindow",""):window._liff.postMessage("closeWindow","","",""):me("closeWindow"):window.close()}var Xu=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"closeWindow"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return we()}},t}(v);function Yn(e){var t=k("subWindowGetOrigin");return D(t(e))}var _e={};function Ve(e,t){e&&_e[e]&&_e[e].forEach(function(r){r(t)})}function zn(e,t){_e[e]||(_e[e]=[]),_e[e].push(t)}function Xn(e,t){if(_e[e]){var r=_e[e].indexOf(t);r>=0&&_e[e].splice(r,1)}}var Qn,Zn,eo,to,lr,ro=function(){function e(t){this.storage=t}return e.prototype.getItem=function(t){return this.storage.getItem("".concat(this.getKeyPrefix(),":").concat(t))},e.prototype.setItem=function(t,r){this.storage.setItem("".concat(this.getKeyPrefix(),":").concat(t),r)},e.prototype.removeItem=function(t){this.storage.removeItem("".concat(this.getKeyPrefix(),":").concat(t))},e.prototype.clear=function(){this.storage.clear()},e.prototype.getKeyPrefix=function(){return"".concat(re,":").concat(this.getLiffId())},e.prototype.getLiffId=function(){var t=P().liffId;if(!t)throw f(z,"liffId is necessary for liff.init()");return t},e}(),no=new ro(new $t);function Ct(){var e=no.getItem("subWindowStatusUpdated");return e!==null&&JSON.parse(e)}function Pe(e){no.setItem("subWindowStatusUpdated",String(e))}function fr(e){Qn=e}function ct(){return Qn}function dr(){return eo}function Jn(){return to}function pr(){return d(this,arguments,void 0,function(e){return e===void 0&&(e=Ne.MAIN),p(this,function(t){switch(t.label){case 0:return[4,(lr=new Gn(e)).setup()];case 1:return t.sent(),[2,lr]}})})}function Ee(){return lr}var qi=new $t,oo=new ro(wt()?qi:window.sessionStorage);function io(e){oo.setItem("mainWindowOrigin",e)}function hr(){return oo.getItem("mainWindowOrigin")}function ao(e){return d(this,arguments,void 0,function(t,r){var n,o,i,a,s,u,l,c;return r===void 0&&(r={}),p(this,function(m){switch(m.label){case 0:if((n=Ee())!=null&&n.isReady())return[3,5];if(o=JSON.stringify(r),i=P().liffId,a=hr(),!window.opener||!a||!i)throw f(ze);s=!1,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,Yn(i)];case 2:return u=m.sent(),s=u.subwindowCommonModule,[3,4];case 3:throw l=m.sent(),T.debug(l),f(ze);case 4:return c=s?a:location.origin,[2,new Promise(function(h){window.addEventListener("message",function w(b){Ji(b)&&(window.removeEventListener("message",w),h({status:t,result:o}))}),window.opener.postMessage({status:t,result:o},c)})];case 5:return n.send({eventName:t,data:r}),[4,new Promise(function(h){setTimeout(h,500)})];case 6:return m.sent(),[2,{status:t,result:JSON.stringify(r)}]}})})}function Ji(e){return!(!e.data||typeof e.data.type!="string"||![x.SUBMIT,x.CANCEL].includes(e.data.type))}function mr(e){var t,r=Jn();if(e.origin===r){var n=e.data;if(n){var o,i=n.status,a=n.result;try{o=JSON.parse(a||"{}")}catch{o={}}switch(i){case Ue:window.clearInterval(dr()),gr();break;case x.CANCEL:case x.SUBMIT:Pe(!0),window.clearInterval(dr()),window.removeEventListener("message",mr),Ve(i,o),(t=ct())===null||t===void 0||t.postMessage({type:i},Jn());break;default:T.debug("unexpected message")}}}}var $i=function(e){return d(void 0,void 0,void 0,function(){var t,r,n,o;return p(this,function(i){if(Ct())return[2];switch(t=e.context,r=t.eventName,n=t.data,o=Ee(),r){case x.INIT:uo(!n.hasOpener);break;case x.CANCEL:case x.SUBMIT:Pe(!0),Ve(r,n),o==null||o.reply(e,{eventName:r});break;case x.CLOSE:Ct()===!1&&(Pe(!0),Ve(x.CLOSE,{})),gr()}return[2]})})};function so(){window.clearInterval(Zn),window.clearInterval(dr()),window.removeEventListener("message",mr)}function uo(e){if(e===void 0&&(e=!1),so(),Pe(!1),e){var t=ct();t&&(t.close(),fr(null))}}function gr(){return d(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return(e=Ee())?[4,e.teardown()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}function Yi(e){return d(this,void 0,void 0,function(){var t,r,n,o,i,a,s,u,l,c,m,h;return p(this,function(w){switch(w.label){case 0:return(t=et(e.url))?(uo(!0),[4,gr()]):[2,Promise.reject(f(L,"params.url must be liff url or mini url"))];case 1:return w.sent(),fr(R()!=="ios"||Be()?window.open("","liffsubwindow","width=480, height=640, menubar=no, toolbar=no, scrollbars=yes"):window.open()),r=e.url,n=e.appData,(o=new URL(r)).searchParams.append(dt,"true"),[4,pr()];case 2:return i=w.sent(),o.searchParams.append(At,i.identification.identifier),o.searchParams.append(St,i.identification.cryptoKey),o.hostname=function(y){var _=I(y.split(".")),E=_[0],A=_.slice(1);return N(["".concat(E,"-ext")],I(A),!1).join(".")}(o.hostname),a=o.toString(),[4,Yn(t)];case 3:if(s=w.sent(),u=s.origin,l=s.subwindowCommonModule,!(c=ct()))throw f(Ye);if(!l)return c.close(),[2];(function(y){to=y})(u),i.listen($i),i.setData("appData",n),window.addEventListener("message",mr),w.label=4;case 4:return w.trys.push([4,6,,7]),[4,(h=e.onBeforeTransition)===null||h===void 0?void 0:h.call(e)];case 5:return w.sent(),[3,7];case 6:throw m=w.sent(),c.close(),m;case 7:return c.location.href=a,b=function(y,_){var E=ct(),A={type:Ue};return _&&(A.message=JSON.stringify(_)),window.setInterval(function(){E==null||E.postMessage(A,y)},Ht)}(u,n),eo=b,function(y){Zn=y}(window.setInterval(function(){var y=ct();y&&y.closed&&(so(),fr(null),Ct()===!1&&(Pe(!0),Ve(x.CLOSE,{})))},un)),[2]}var b})})}var ut=null;function co(e){return d(this,void 0,void 0,function(){var t,r,n,o,i,a,s,u,l,c,m,h,w,b,y=this;return p(this,function(_){switch(_.label){case 0:if(t=e.msit,r=e.mstChallenge,n=e.reconnectCount,o=n===void 0?0:n,i=function(){return d(y,void 0,void 0,function(){return p(this,function(E){switch(E.label){case 0:return[4,(A=1e3,new Promise(function(Z){return setTimeout(Z,A)}))];case 1:return E.sent(),[4,co({msit:t,mstChallenge:r,onSuccess:e.onSuccess,onError:e.onError,reconnectCount:o+1})];case 2:return E.sent(),[2]}var A})})},a=function(){for(var E=[],A=0;A<arguments.length;A++)E[A]=arguments[A];ut=null,e.onSuccess.apply(e,N([],I(E),!1))},s=function(){for(var E=[],A=0;A<arguments.length;A++)E[A]=arguments[A];ut=null,e.onError.apply(e,N([],I(E),!1))},u=Date.now(),ut===null&&(ut=u),l=u-ut,o>=10||l>6e5)return s(f(W,"Failed to connect")),[2];_.label=1;case 1:return _.trys.push([1,3,,5]),[4,Hn(k("subWindowSubscribe"),{method:"POST",body:JSON.stringify({msit:t,mstChallenge:r})})];case 2:return c=_.sent(),[3,5];case 3:return _.sent(),[4,i()];case 4:return _.sent(),[2];case 5:return c.status>=500?[4,i()]:[3,7];case 6:return _.sent(),[3,17];case 7:return c.status>=400&&500>c.status?[4,$n(c)]:[3,9];case 8:return h=_.sent(),m=h?f(L,h.errorDetail):f(W,"Some error happened in the server"),s(m),[3,17];case 9:return c.status!==200?[3,16]:[4,$n(c)];case 10:if(!(h=_.sent()))return s(f(W,"Some error happened in the server")),[2];switch(w=h.status,b=h.result,w){case x.ERROR:return[3,11];case x.CLOSE:case x.CANCEL:case x.SUBMIT:return[3,13]}return[3,14];case 11:return[4,i()];case 12:return _.sent(),[3,15];case 13:return a(w,b),[3,15];case 14:s(f(W,"Some error happened in the server")),_.label=15;case 15:return[3,17];case 16:s(f(W,"Some error happened in the server")),_.label=17;case 17:return[2]}})})}function $n(e){return d(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e.json()];case 1:return[2,t.sent()];case 2:return t.sent(),[2,null];case 3:return[2]}})})}function zi(e){var t={};return Object.keys(e).forEach(function(r){r==="closeButtonColor"?e[r]==="white"?t[r]="#ffffff":t[r]="#000000":t[r]=e[r]}),t}var Xi={height:"full",closeButtonPosition:"right",closeButtonColor:"black",closeButtonLabel:""};function Qi(e){var t=e.appData,r=e.native,n=P().liffId,o=_t(),i=et(e.url);if(!n)return Promise.reject(f(B,"liffId is invalid"));if(!o)return Promise.reject(f(B,"mst_challenge is invalid"));if(!i)return Promise.reject(f(L,"params.url must be liff url or mini url"));var a=Object.assign({},Xi,r);return function(s){var u=s.mainLiffId,l=s.subLiffId,c=s.mstChallenge,m=s.appData,h=s.view;return u&&c?D(k("subWindowGetMSIT"),{method:"POST",body:JSON.stringify({mainLiffId:u,subLiffId:l,mstChallenge:c,appData:m,view:h})}):Promise.reject(f(L,"no proper argument"))}({mainLiffId:n,subLiffId:i,mstChallenge:o,appData:t,view:zi(a)}).then(function(s){var u=s.msit;return co({msit:u,mstChallenge:o,onSuccess:function(l,c){Ve(l,c)},onError:function(l){Ve(x.ERROR,l)}}),u}).then(function(s){return function(u,l){return d(this,void 0,void 0,function(){var c,m,h;return p(this,function(w){switch(w.label){case 0:return c=u.url,(m=new URLSearchParams).set("msit",l),[4,(h=u.onBeforeTransition)===null||h===void 0?void 0:h.call(u)];case 1:return w.sent(),location.href="".concat(sn,"?url=").concat(encodeURIComponent(c),"&").concat(m.toString()),[2]}})})}(e,s)})}function lo(e){return oe.subwindowOpen(),S()?Qi(e):Yi(e)}function vr(e){if(!e.mst||!e.status)return Promise.reject(f(L,"no proper argument"));var t=JSON.stringify(e);return D(k("subWindowPost"),{method:"POST",body:t})}function Lt(){if(!ae())throw f(B,"this api can be only called in child window")}function fo(e){return e===void 0&&(e={}),Lt(),S()?function(){return d(this,arguments,void 0,function(t){var r,n;return t===void 0&&(t={}),p(this,function(o){switch(o.label){case 0:return(r=We())?[4,vr({mst:r,status:x.CANCEL,result:t})]:[2,Promise.reject(f(B,"mst is invalid"))];case 1:return n=o.sent(),Pe(!0),[2,n]}})})}(e):function(t){return t===void 0&&(t={}),ao(x.CANCEL,t)}(e)}function po(e){return e===void 0&&(e={}),Lt(),S()?function(){return d(this,arguments,void 0,function(t){var r,n;return t===void 0&&(t={}),p(this,function(o){switch(o.label){case 0:return(r=We())?[4,vr({mst:r,status:x.SUBMIT,result:t})]:[2,Promise.reject(f(B,"mst is invalid"))];case 1:return n=o.sent(),Pe(!0),[2,n]}})})}(e):function(t){return t===void 0&&(t={}),ao(x.SUBMIT,t)}(e)}function ho(){return Lt(),S()?function(){return d(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return Ct()!==!1?[3,2]:(e=We())?[4,vr({mst:e,status:x.CLOSE,result:{}})]:[2,Promise.reject(f(B,"mst is invalid"))];case 1:t.sent(),t.label=2;case 2:return we(),[2]}})})}():function(){return d(this,void 0,void 0,function(){var e;return p(this,function(t){return(e=Ee())!=null&&e.isReady()?(e.send({eventName:x.CLOSE}),[2,new Promise(function(r){setTimeout(function(){we(),r()},Ht)})]):(we(),[2,Promise.resolve()])})})}()}function mo(){return Lt(),function(){var e,t=En();try{e=t?JSON.parse(t):{}}catch{e={}}return Promise.resolve(e)}()}function go(e){var t=e.msit,r=e.mstVerifier;return t&&r?D(k("subWindowGetMSTByMSIT"),{method:"POST",body:JSON.stringify({msit:t,mstVerifier:r})}):Promise.reject(f(L,"no proper argument"))}function vo(e){var t=e.mst;return t?D(k("subWindowGetAppData"),{method:"POST",body:JSON.stringify({mst:t})}):Promise.reject(f(L,"no proper argument"))}var X={on:zn,off:Xn,open:lo,cancel:fo,submit:po,close:ho,getAppData:mo},dc=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"subWindow"},enumerable:!1,configurable:!0}),t.prototype.install=function(){var r=this;return{on:zn.bind(this),off:Xn.bind(this),open:function(n){return lo.call(r,M(M({},n),{onBeforeTransition:void 0}))},cancel:fo.bind(this),submit:po.bind(this),close:ho.bind(this),getAppData:mo.bind(this)}},t}(v);var Io=ci(bo());var yo=function(){var e=this;this.type="sync",this.fns=new Set,this.on=function(t){e.fns.add(t)},this.call=function(){for(var t,r,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{for(var i=ve(e.fns),a=i.next();!a.done;a=i.next()){var s=a.value;s.apply(void 0,N([],I(n),!1))}}catch(u){t={error:u}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}}},Ge=function(){var e=this;this.type="async",this.fns=new Set,this.on=function(t){e.fns.add(t)},this.call=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return d(e,void 0,void 0,function(){var n,o,i,a,s,u;return p(this,function(l){switch(l.label){case 0:n=[];try{for(o=ve(this.fns),i=o.next();!i.done;i=o.next())a=i.value,n.push(a.apply(void 0,N([],I(t),!1)))}catch(c){s={error:c}}finally{try{i&&!i.done&&(u=o.return)&&u.call(o)}finally{if(s)throw s.error}}return[4,Promise.all(n)];case 1:return l.sent(),[2]}})})}};var Ke=function(e){var t,r=he(43),n=gn((0,Io.default)(r)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),o=P();if(!o||!o.liffId)throw f(z,"You need to define `liffId` for liff.login()");var i={app_id:o.liffId,state:he(12),response_type:"code",code_challenge_method:"S256",code_challenge:n,liff_sdk_version:ye()};e&&e.redirectUri&&(i.redirect_uri=e.redirectUri),ae()&&!S()&&(!((t=Ee())===null||t===void 0)&&t.isReady()?i.redirect_uri=window.location.href:i.disable_auto_login="true"),kn({codeVerifier:r});var a=k("authorize")+"?"+j.stringify(i);T.debug("[Redirect] ".concat(a)),window.location.href=a},_o=function(e){function t(){var r=e.apply(this,N([],I(arguments),!1))||this;return r.hooks={before:new yo},r}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"login"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return this._login.bind(this)},t.prototype._login=function(r){this.hooks.before.call(r),Ke(r)},t}(v);var wr,Nt=typeof navigator>"u"?"en":(wr=navigator.language)!==null&&wr!==void 0?wr:"en",br=null;function Zi(e){return d(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return Nt=e,[4,Eo()];case 1:return t.sent(),[2]}})})}function Eo(){return d(this,void 0,void 0,function(){var e,t;return p(this,function(r){switch(r.label){case 0:return[4,D("".concat("https://liffsdk.line-scdn.net/xlt/manifest.json"),{method:"GET",headers:{Accept:"application/json"}})];case 1:return e=r.sent(),t="".concat(Nt),!e.languages[t]&&Nt.includes("-")&&(t=Nt.split("-")[0]),e.languages[t]||(t="en"),[4,D("".concat("https://liffsdk.line-scdn.net/xlt","/").concat(e.languages[t]),{method:"GET",headers:{Accept:"application/json"}})];case 2:return br=r.sent(),[2]}})})}function Pt(e){if(br===null)throw f(U,"please call xlt after liff.init");return br[e]}var ea=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"i18n"},enumerable:!1,configurable:!0}),t.prototype.install=function(r){return r.internalHooks.init.beforeFinished(this.beforeInitFinished.bind(this)),{setLang:Zi}},t.prototype.beforeInitFinished=function(){return d(this,void 0,void 0,function(){return p(this,function(r){switch(r.label){case 0:return[4,Eo()];case 1:return r.sent(),[2]}})})},t}(v),So=new ea;var To={iconColor:"#111111",statusBarColor:"BLACK",titleTextColor:"#111111",titleSubtextColor:"#B7B7B7",titleButtonColor:"#111111",titleBackgroundColor:"#FFFFFF",progressBarColor:"#06C755",progressBackgroundColor:"#FFFFFF",titleButtonAreaBackgroundColor:"#1FFFFFFF",titleButtonAreaBorderColor:"#26000000",baseBackgroundColor:"#FFFFFF",baseTextColor:"#000000",lightButtonBorderColor:"rgba(0, 0, 0, 0.15)"},Ao={iconColor:"#FFFFFF",statusBarColor:"WHITE",titleTextColor:"#FFFFFF",titleSubtextColor:"#949494",titleButtonColor:"#FFFFFF",titleBackgroundColor:"#111111",progressBarColor:"#06C755",progressBackgroundColor:"#111111",titleButtonAreaBackgroundColor:"#1FFFFFFF",titleButtonAreaBorderColor:"#26000000",baseBackgroundColor:"#000000",baseTextColor:"#FFFFFF",lightButtonBorderColor:"rgba(255, 255, 255, 0.5)"};function ta(){var e;Q("color-scheme",(((e=F())==null?void 0:e.menuColorSetting)||{adaptableColorSchemes:["light"]}).adaptableColorSchemes.join(" "));var t=window.matchMedia("(prefers-color-scheme: dark)");yr({matches:t==null?void 0:t.matches,media:t==null?void 0:t.media}),t.addEventListener?t.addEventListener("change",yr):t.addListener&&t.addListener(yr)}function yr(e){var t=F(),r=(t==null?void 0:t.menuColorSetting)||{adaptableColorSchemes:["light"],lightModeColor:To,darkModeColor:Ao},n=r.adaptableColorSchemes,o=r.lightModeColor,i=r.darkModeColor,a=n.includes("dark");e.matches&&a?Co(M(M({},Ao),i)):Co(M(M({},To),o))}function Co(e){var t=e.iconColor,r=e.statusBarColor,n=e.titleTextColor,o=e.titleSubtextColor,i=e.titleButtonColor,a=e.titleBackgroundColor,s=e.progressBarColor,u=e.progressBackgroundColor,l=e.titleButtonAreaBackgroundColor,c=e.titleButtonAreaBorderColor,m=e.baseBackgroundColor,h=e.baseTextColor,w=e.lightButtonBorderColor;Q("--liff-base-background-color",m),Q("--liff-base-text-color",h),Q("--liff-base-background-rgb-color",Kt(m)),Q("--liff-base-text-rgb-color",Kt(h)),Q("--liff-light-button-border-color",w),Q("--liff-title-text-color",n),Q("--liff-title-background-color",a),Q("--liff-title-button-color",i),Q("--liff-icon-color",t),Q("--liff-status-bar-color",r),Q("--liff-title-subtext-color",o),Q("--liff-progress-bar-color",s),Q("--liff-progress-background-color",u),Q("--liff-title-button-area-background-color",Gt(l)),Q("--liff-title-button-area-border-color",Gt(c))}function Q(e,t){document.documentElement.style.setProperty(e,t)}var ra={addToHomeScreen:function(e){if(!new Et(e).invoke("addToHomeScreen"))throw f(C,"No permission for liff.addToHomeScreen()")},scanCode:function(e){if(!new Et(e).invoke("scanCode"))return Promise.reject(f(C,"No permission for liff.scanCode()"))},getAdvertisingId:function(e){if(!new Et(e).invoke("getAdvertisingId"))return Promise.reject(f(C,"No permission for liff.getAdvertisingId()"))},initPlugins:function(){}};function na(e){return d(this,void 0,void 0,function(){var t;return p(this,function(r){switch(r.label){case 0:return[4,Wn()];case 1:return(t=r.sent())?(t.install(e,ra),[2]):[2]}})})}function oa(){return d(this,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,D(k("certs"))];case 1:return[2,e.sent()]}})})}function ia(e,t,r){return d(this,void 0,void 0,function(){var n;return p(this,function(o){switch(o.label){case 0:return[4,crypto.subtle.importKey("jwk",e,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"])];case 1:return n=o.sent(),[4,crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},n,r,t)];case 2:return[2,o.sent()]}})})}function Oo(e,t){return d(this,void 0,void 0,function(){var r,n,o,i,a,s,u,l,c,m,h,w,b,y,_,E;return p(this,function(A){switch(A.label){case 0:return r=e.split("."),n=I(r,3),o=n[0],i=n[1],a=n[2],s=JSON.parse(pt.decode(o)),u=JSON.parse(pt.decodeUnicode(i)),l=qt(pt.decode(a)),c=qt("".concat(o,".").concat(i)),[4,oa()];case 1:if(m=A.sent(),!(h=m.keys.find(function(Z){return Z.kid===s.kid})))return[3,6];if(delete h.alg,s.alg!=="ES256")throw f(be,'Invalid "alg" value in ID_TOKEN');w=void 0,A.label=2;case 2:return A.trys.push([2,4,,5]),[4,ia(h,c,l)];case 3:return w=A.sent(),[3,5];case 4:throw b=A.sent(),f(be,"".concat("Failed to use Crypto API to verify ID_TOKEN",": ").concat(b));case 5:if(w){if(y=u.iss!=="https://access.".concat("line.me"),_=u.aud!==t,E=1e3*u.exp<Date.now(),y)throw f(be,'Invalid "iss" value in ID_TOKEN');if(_)throw f(be,'Invalid "aud" value in ID_TOKEN');if(E)throw f(be,'Invalid "exp" value in ID_TOKEN');return[2,u]}throw f(be,"Invalid signature in ID_TOKEN");case 6:throw f(be,'Invalid "kid" value in ID_TOKEN');case 7:return[2]}})})}function Sr(e){var t=e.split(".");if(t[1])try{var r=t[1].replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(window.atob(r))}catch{return null}return null}function No(e){var t=e.pathname,r=e.query,n=r?"?".concat(j.stringify(r)):"",o="".concat("liff://").concat(t).concat(n);location.href=o}var _r=null;function aa(){typeof _r=="boolean"&&T.warn("liff.init is not expected to be called more than once"),_r=!!In()||!(!S()||j.parse(window.location.hash).feature_token||Le())&&(_n(!0),!0)}function Er(){return!!_r}function sa(e,t){return d(this,void 0,void 0,function(){var r;return p(this,function(n){switch(n.label){case 0:return(r=We())?[2,r]:e&&t?[4,go({msit:e,mstVerifier:t})]:[3,2];case 1:return[2,n.sent().mst];case 2:return[2,null]}})})}function ua(e){return D("".concat(k("apps"),"/").concat(e,"/featureToken"))}function ca(e){return d(this,void 0,void 0,function(){var t,r,n,o;return p(this,function(i){switch(i.label){case 0:return t=j.parse(window.location.hash),r=function(a){for(var s,u,l=[],c=1;c<arguments.length;c++)l[c-1]=arguments[c];var m=function(b){Object.keys(b).filter(function(y){return b[y]!==null&&b[y]!==void 0}).forEach(function(y){a[y]=b[y]})};try{for(var h=ve(l),w=h.next();!w.done;w=h.next())m(w.value)}catch(b){s={error:b}}finally{try{w&&!w.done&&(u=h.return)&&u.call(h)}finally{if(s)throw s.error}}return a}({access_token:ne(),context_token:Pn(),feature_token:Le(),id_token:je(),client_id:Nn(),mst_challenge:_t(),mst_verifier:Sn(),msit:An()},t),Er()?H()?[4,ua(e)]:[3,2]:[3,3];case 1:n=i.sent().featureToken,r.feature_token||(r.feature_token=n),i.label=2;case 2:(o=Ze(e))&&(r.client_id=o),i.label=3;case 3:return[2,r]}})})}function la(e){if(e.persisted&&Ie("multipleLiffTransition"))if(R()==="ios")window.location.reload();else{var t=P().liffId,r=Le();if(!t)throw f(U,"Invalid LIFF ID.");if(!r)throw f(C,"Invalid featureToken for client features");No({pathname:"app/".concat(t),query:{feature_token:r}})}}function fa(e){return d(this,void 0,void 0,function(){var t,r,n,o,i,a,s,u,l,c,m,h,w,b,y,_,E,A,Z;return p(this,function(K){switch(K.label){case 0:return[4,new Promise(function(fe){var ee=J();if(!ee||G(ee,"9.5.0")<0)fe();else if(window._liff&&window._liff.features)fe();else{T.debug("cannot find window._liff.features, listen to ready event");var de=function(){T.debug("ready event is fired"),st("ready",de),fe()};at("ready",de)}})];case 1:return K.sent(),aa(),[4,ca(e.liffId)];case 2:if(t=K.sent(),r=t.access_token,n=t.context_token,o=t.feature_token,i=t.id_token,a=t.client_id,s=t.mst_verifier,u=t.mst_challenge,l=t.msit,n){if(typeof n!="string")throw f(U,"Cannot get context token, perhaps there is an incorrect parameter in permanent link");yt(Sr(n))}if(((A=F())===null||A===void 0?void 0:A.liffId)!==void 0&&((Z=F())===null||Z===void 0?void 0:Z.liffId)!==e.liffId)throw f(U,"Invalid LIFF ID");return!ae()&&o&&(function(fe,ee){Ie("multipleLiffTransition")&&No({pathname:"app/".concat(fe),query:{feature_token:ee}})}(e.liffId,o),Er()&&er(o)),u&&On(u),s&&Tn(s),a&&Zt(a),l&&Cn(l),window.addEventListener("pageshow",la),H()?[3,5]:o&&r?[3,5]:Er()?(c=Fe(location.href,{"liff.hback":"2"}),Ke({redirectUri:c}),[4,new Promise(function(){})]):[3,4];case 3:K.sent(),K.label=4;case 4:throw Ke(),f(U,"Failed to parse feature_token or access_token");case 5:return r&&o?[4,nt(r)]:[3,7];case 6:if(m=K.sent(),h=m.client_id,w=m.expires_in,b=Ze(e.liffId),h!==b)throw Ke(),f(U,"Failed to verify access_token");er(o),or(new Date(Date.now()+1e3*w)),tt(r),K.label=7;case 7:return[4,sa(l,s)];case 8:return(y=K.sent())?(Ln(y),[4,vo({mst:y})]):[3,10];case 9:(_=K.sent().data)&&It(JSON.stringify(_)),K.label=10;case 10:return i&&!je()&&tr(i),i&&a&&!Oe()?[4,Oo(i,a)]:[3,12];case 11:(E=K.sent())&&ir(E),K.label=12;case 12:return[2]}})})}function da(e){return d(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return p(this,function(u){switch(u.label){case 0:return t=k("apps"),r="".concat(t,"/").concat(e,"/contextToken"),n=ne(),o={"Content-Type":"application/json",Accept:"application/json"},n&&(o.Authorization="Bearer ".concat(n)),[4,D(r,{headers:o})];case 1:if(i=u.sent(),!(a=i.contextToken))throw f(U,"Can not get context from server.");if(!(s=Sr(a)))throw f(U,"Invalid context token.");return[2,s]}})})}function Po(){return d(this,void 0,void 0,function(){var e,t;return p(this,function(r){switch(r.label){case 0:if(!(e=P().liffId))throw f(U,"Invalid LIFF ID.");return[4,da(e)];case 1:return t=r.sent(),yt(t),[2]}})})}function pa(e){return d(this,void 0,void 0,function(){var t,r,n,o=this;return p(this,function(i){switch(i.label){case 0:t=function(){return d(o,void 0,void 0,function(){var a,s,u,l,c,m;return p(this,function(h){switch(h.label){case 0:return[4,(w=P(),b=j.parse(window.location.search),y=rr(),_={grant_type:"authorization_code",client_id:b.liffClientId,appId:w.liffId,code:b.code,code_verifier:y.codeVerifier,redirect_uri:w.redirectUri||b.liffRedirectUri,id_token_key_type:"JWK"},E=j.stringify(_),D(k("token"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:E}))];case 1:return a=h.sent(),s=a.access_token,u=a.id_token,l=a.expires_in,Zt(e),tt(s),or(new Date(Date.now()+1e3*l)),nr(),u?(tr(u),[4,Oo(u,e)]):[3,3];case 2:(c=h.sent())&&ir(c),h.label=3;case 3:return(m=j.parse(location.hash).context_token)?(yt(Sr(m)),[3,6]):[3,4];case 4:return[4,Po()];case 5:h.sent(),h.label=6;case 6:return[2]}var w,b,y,_,E})})},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t()];case 2:return i.sent(),[3,4];case 3:throw r=i.sent(),n=r,nr(),n;case 4:return[2]}})})}function xo(){return d(this,void 0,void 0,function(){var e,t,r,n,o,i,a=this;return p(this,function(s){switch(s.label){case 0:return(t=Ee())?[3,2]:[4,pr(Ne.SUB)];case 1:t=s.sent(),s.label=2;case 2:return(e=t).isReady()?(r=he(8),[4,e.getData("appData")]):[3,8];case 3:return n=s.sent(),o=n.eventName,i=n.data,o!==ot.NOT_FOUND?[3,6]:[4,e.teardown()];case 4:return s.sent(),[4,xo()];case 5:return[2,s.sent()];case 6:i&&It(JSON.stringify(i)),s.label=7;case 7:return e.listen(function(u){return d(a,void 0,void 0,function(){var l,c;return p(this,function(m){return l=u.context,c=l.data,l.eventName===x.INIT&&(c==null?void 0:c.subWindowId)!==r&&we(),l.eventName!==x.CANCEL&&l.eventName!==x.SUBMIT||e.teardown(),[2]})})}),H()&&e.send({eventName:x.INIT,data:{subWindowId:r,hasOpener:!!window.opener}}),[3,10];case 8:return hr()?[3,10]:[4,new Promise(function(u){window.addEventListener("message",function(l){return function c(m){var h=m.data,w=m.source,b=m.origin;if(h){var y=h.type,_=h.message;y===Ue&&(window.removeEventListener("message",c),_&&It(_),io(b),w&&w.postMessage&&w.postMessage({status:Ue},b),l())}}}(u))})];case 9:return[2,s.sent()];case 10:return[2]}})})}var ha=new(function(){function e(){var t=this;this.getAndValidateContext=function(){var r=F();if(!r)throw f(U,"Could not get Context from server.");if(!r.endpointUrl)throw f(U,"Could not get endpointUrl from server.");if(!r.permanentLinkPattern)throw f(U,"Could not get permanentLinkPattern from server.");return r},this.decodeState=function(r){var n=t.getAndValidateContext();r=r.replace(/\n/g,"%0D%0A");var o=t.hasTrailingSlash(n.endpointUrl)||t.hasTrailingSlash(r),i=new URL(n.endpointUrl),a=i.origin,s=i.pathname,u=i.search,l=new URL("".concat(a).concat(t.attachSlashAtStart(r))),c=l.pathname,m=l.search,h=l.hash,w="".concat(u).concat(u?m.replace(/\?/g,"&"):m),b="".concat(s).concat(t.attachSlashAtStart(c)).replace("//","/");return(b=t.attachSlashAtStart("".concat(b))).endsWith("/")&&!o&&(b=b.substring(0,b.length-1)),"".concat(a).concat(b).concat(w).concat(h).replace(/%0D%0A/g,"\n")}}return e.prototype.attachSlashAtStart=function(t){return"".concat(t&&t.length>0&&!t.startsWith("/")?"/":"").concat(t)},e.prototype.hasTrailingSlash=function(t){var r=t.indexOf("?"),n=t.indexOf("#"),o=-1;return(o=r===-1&&n===-1?t.length:r===-1?n:n===-1?r:Math.min(r,n))>0&&t[o-1]==="/"},e.prototype.invoke=function(){return d(this,void 0,void 0,function(){var t,r,n,o,i;return p(this,function(a){switch(a.label){case 0:if(t=j.parse(window.location.search),typeof(r=t["liff.state"])!="string")return[2];a.label=1;case 1:return a.trys.push([1,4,,5]),n=location.href,(o=this.decodeState(r))===n?[3,3]:(t["liff.hback"]?location.replace(Fe(o,{"liff.hback":t["liff.hback"]})):location.replace(o),[4,new Promise(function(){})]);case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if((i=a.sent()).code===U)throw i;return T.debug(i),[3,5];case 5:return[2]}})})},e}());function ma(e,t){return d(this,void 0,void 0,function(){var r;return p(this,function(n){switch(n.label){case 0:if(!e.liffId)throw f(z,"liffId is necessary for liff.init()");return yn(e),!S()&&H()&&(Mn()||rt()),r=j.parse(window.location.search),!ae()||S()?[3,2]:[4,xo()];case 1:n.sent(),n.label=2;case 2:if(r.error&&r.liffOAuth2Error)throw a=r.error,s=r.error_description,u=s.replace(/\+/g," "),l="".concat(a,": ").concat(u),f(U,l);return o=r.code,i=rr(),o&&!H()&&i&&i.codeVerifier?[4,pa(r.liffClientId)]:[3,4];case 3:n.sent(),n.label=4;case 4:return S()?[4,fa(e)]:[3,6];case 5:return n.sent(),[3,8];case 6:return H()?[3,8]:[4,Po()];case 7:n.sent(),n.label=8;case 8:return[4,ha.invoke()];case 9:return n.sent(),[4,t()];case 10:return n.sent(),vn(window.location.href),[2]}var o,i,a,s,u,l})})}var ko=function(e,t){return new Promise(function(r,n){if(e){var o=document.createElement("script");o.type="module",o.onload=function(){r()},o.src=e,document.head.appendChild(o)}else n(f(z,t))})},ga=function(e){var t="https://static.line-scdn.net/lui/edge/versions/1.13.0/lui-alert.js";return t&&e&&(t=t.replace(/\d{1,2}\.\d{1,2}\.\d{1,3}/,e)),ko(t,"LUI_ALERT_URL is not defined")},Ir=function(){return d(void 0,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return e=function(){var n,o=document.querySelector('script[src*="luivendor.js"]');if(o&&(!((n=o.src.match(/\d{1,2}\.\d{1,2}\.\d{1,3}/g))===null||n===void 0)&&n.length))return o.src.match(/\d{1,2}\.\d{1,2}\.\d{1,3}/g)[0]}(),e?[3,2]:[4,ko("https://static.line-scdn.net/lui/edge/versions/1.13.0/luivendor.js","LUI_VENDOR_URL is not defined")];case 1:t.sent(),t.label=2;case 2:return[4,ga(e)];case 3:return t.sent(),[4,(r=he(6),new Promise(function(){var n=document.createElement("div");n.innerHTML='<lui-alert id="'.concat("liffAlert","-").concat(r,'" shown title="').concat(Pt("alert.android.extBrowser.autoLoginWorkaround.title"),'" message="').concat(Pt("alert.android.extBrowser.autoLoginWorkaround.desc"),'" button="').concat(Pt("alert.android.extBrowser.autoLoginWorkaround.button.text"),'"></lui-alert>'),document.body.appendChild(n);var o=document.getElementById("".concat("liffAlert","-").concat(r));o&&o.addEventListener("lui-button-click",function(){var i=window.open(Fe(window.location.href,{liffIsEscapedFromApp:"true"}),"_blank");i&&(i.location.href=Fe(window.location.href,{liffIsEscapedFromApp:"true"}),window.close())})}))];case 4:return t.sent(),[2]}var r})})},Lo=function(e){try{return new URL(e).searchParams.get("lineAppVersion")}catch{return null}};function va(){return d(this,void 0,void 0,function(){var e,t,r;return p(this,function(n){switch(n.label){case 0:return e=(r=Lo(window.location.href))!==null&&r!==void 0?r:Lo(window.document.referrer),e&&G(e,"13.10.0")>=0?[2]:S()||R()!=="android"||(t=j.parse(window.location.search))[At]||t.liffIsEscapedFromApp?[2]:t.liffClientId&&document.referrer.includes("access.".concat("line.me"))?(window.location.href=Fe(window.location.href,{liffIsEscapedFromApp:"true"}),[2]):t.liffClientId&&document.referrer.includes("android-app://")?[4,Ir()]:[3,2];case 1:n.sent(),n.label=2;case 2:return t.liffClientId&&document.referrer===""&&window.history.length===1?[4,Ir()]:[3,4];case 3:n.sent(),n.label=4;case 4:return!document.referrer.includes("liffClientId")||document.referrer.includes("liffIsEscapedFromApp")?[3,6]:[4,Ir()];case 5:n.sent(),n.label=6;case 6:return[2]}})})}var Mo=function(e){function t(){var r=e.apply(this,N([],I(arguments),!1))||this;return r.hooks={before:new Ge,after:new Ge},r.internalHooks={beforeFinished:new Ge,beforeSuccess:new Ge,error:new Ge},r}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"init"},enumerable:!1,configurable:!0}),t.prototype.install=function(r){var n=r.liff;return this.liffForWindow=n,this.init.bind(this)},t.prototype.init=function(r,n,o){return d(this,void 0,void 0,function(){var i;return p(this,function(a){switch(a.label){case 0:return[4,this.hooks.before.call()];case 1:a.sent(),s=this.liffForWindow,window&&!window.liff&&(window.liff=s),a.label=2;case 2:return a.trys.push([2,9,,11]),[4,Promise.all([na(this.liffForWindow),ma(r,this.internalHooks.beforeFinished.call)])];case 3:return a.sent(),ta(),[4,this.internalHooks.beforeSuccess.call()];case 4:return a.sent(),!r.withLoginOnExternalBrowser||H()?[3,6]:(Ke(),[4,new Promise(function(){})]);case 5:a.sent(),a.label=6;case 6:return[4,va()];case 7:return a.sent(),[4,this.hooks.after.call()];case 8:return a.sent(),typeof n=="function"&&n(),Bt(),[3,11];case 9:return i=a.sent(),[4,this.internalHooks.error.call(i)];case 10:throw a.sent(),typeof o=="function"&&o(i),i;case 11:return[2]}var s})})},t}(v);function Tr(){return{liffApp:"https://liff.".concat("line.me"),liffServer:"https://api.".concat("line.me"),miniApp:"https://miniapp.".concat("line.me")}}var ul=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getOrigins"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return Tr()}},t}(v);function Ar(){return navigator.language}var dl=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getLanguage"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return Ar()}},t}(v);function Cr(){var e=J();if(!e||!S()||R()!=="ios")return navigator.language;if(G(e,"14.11.0")>=0){var t=window.prompt("LIFF:GET_APP_LANGUAGE");if(t)return t}return navigator.language}var yl=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getAppLanguage"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(){return Cr()}},t}(v);function Do(e){return d(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return p(this,function(u){switch(u.label){case 0:return function(l){if(!cn.includes(l))throw f(L,"Unexpected permission name.");var c=F();return!!(c!=null&&c.scope.includes(l))}(e)?(t=ne())?[4,nt(t)]:[3,2]:[2,{state:"unavailable"}];case 1:r=u.sent(),n=unescape(r.scope).split(" ");try{for(o=ve(n),i=o.next();!i.done;i=o.next())if(i.value.includes(e))return[2,{state:"granted"}]}catch(l){a={error:l}}finally{try{i&&!i.done&&(s=o.return)&&s.call(o)}finally{if(a)throw a.error}}return[2,{state:"prompt"}];case 2:throw f(B,"Need access_token for api call, Please login first")}})})}function Ro(){var e,t,r=F();return!!r&&r.type!=="square_chat"&&(Ie("skipChannelVerificationScreen")||!S()&&((t=(e=r.availability)===null||e===void 0?void 0:e.skipChannelVerificationScreen)===null||t===void 0?void 0:t.permission))}function wa(){var e=P().liffId;if(e)return D("".concat(k("unauthorizedPermissions"),"?liffId=").concat(e),{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(ne())}});throw f(B,"liffId is required")}var Mt,xt=X.on,kt=X.off,ba=X.open,ya=function(){function e(t,r){var n=this;this.onSubmit=function(o){return d(n,[o],void 0,function(i){var a=i.newAccessToken,s=i.ICA_ERROR;return p(this,function(u){return a?this.resolve({newAccessToken:a}):s&&this.reject(f(W,s)),this.teardown(),[2]})})},this.onClose=function(){return d(n,void 0,void 0,function(){return p(this,function(o){return this.reject(f(B,"user didn't allow the agreement")),this.teardown(),[2]})})},this.onCancel=function(){return d(n,void 0,void 0,function(){return p(this,function(o){return this.reject(f(B,"user didn't allow the agreement")),this.teardown(),[2]})})},this.onError=function(o){return d(n,void 0,void 0,function(){return p(this,function(i){return this.reject(o),this.teardown(),[2]})})},this.resolve=t,this.reject=r,this.setup()}return e.prototype.setup=function(){xt("submit",this.onSubmit),xt("close",this.onClose),xt("cancel",this.onCancel),xt("error",this.onError)},e.prototype.teardown=function(){kt("submit",this.onSubmit),kt("close",this.onClose),kt("cancel",this.onCancel),kt("error",this.onError),Mt=void 0},e.prototype.open=function(t){var r=P().liffId;r?ba({url:"".concat("https://liff.line.me/1656032314-Xgrw5Pmk"),appData:{liffId:r,channelId:Ze(r),accessToken:ne()},onBeforeTransition:t}).catch(this.reject):this.reject(f(B,"liffId is required"))},e}();function Uo(){return d(this,void 0,void 0,function(){var e,t,r=this;return p(this,function(n){switch(n.label){case 0:if(!Ro())throw f(C,"SkipChannelVerificationScreen is unavailable.");return Mt&&Mt.teardown(),e=function(){return d(r,void 0,void 0,function(){var o;return p(this,function(i){switch(i.label){case 0:return[4,wa()];case 1:if(o=i.sent(),(S()?o:o.filter(function(a){return a!=="chat_message.write"})).length<=0)throw f(C,"All permissions have already been approved.");return[2]}})})},[4,new Promise(function(o,i){(Mt=new ya(o,i)).open(e)})];case 1:return t=n.sent().newAccessToken,tt(t),[2]}})})}function Ia(){return d(this,void 0,void 0,function(){var e,t;return p(this,function(r){switch(r.label){case 0:if(!(e=ne()))throw f(B,"Need access_token for api call, Please login first");return[4,nt(e)];case 1:return t=r.sent(),[2,decodeURIComponent(t.scope).split(" ").filter(function(n){return n!==""})]}})})}function ge(e,t){var r=this;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return d(r,void 0,void 0,function(){var i,a,s;return p(this,function(u){switch(u.label){case 0:return i=(n.length>0?n[n.length-1]:{}).ignorePermissionCheck,a=i!==void 0&&i,[4,Do(t)];case 1:if((s=u.sent().state)!=="unavailable")return[3,2];throw f(C,"The permission is not in LIFF app scope.");case 2:return s!=="prompt"||!Ro()||a||!S()&&t==="chat_message.write"?[3,4]:[4,Uo()];case 3:return u.sent(),[3,5];case 4:a&&n.pop(),u.label=5;case 5:return[4,e.apply(void 0,N([],I(n),!1))];case 6:return[2,u.sent()]}})})}}var _a=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"permission"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return{query:Do,requestAll:Uo,getGrantedAll:Ia}},t}(v),Fo=new _a;function lt(){return D(k("profile"))}var Rl=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getProfile"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return ge(lt,"profile")},t}(v);var Ea=function(e,t){return e?"&".concat(e.split("&").filter(function(r){return r.indexOf("is_liff_external_open_window")===-1}).join("&").concat("".concat(t?"#".concat(t):""))):"".concat(t?"#".concat(t):"")};function qe(e){if(!function(i){if(!i||typeof i!="object")return!1;var a=i,s=a.url,u=a.external,l=I([typeof s,typeof u],2),c=l[0],m=l[1];return c==="string"&&s!==""&&(m==="undefined"||m==="boolean")}(e))throw f(L,"Invalid parameters for liff.openWindow()");var t=J();if(S())if(t!==null&&R()==="ios"&&G(t,"9.19")>=0||!window._liff.postMessage){var r=e.url,n=e.external,o=n!==void 0&&n;window.open(function(i,a){var s,u,l,c,m,h,w,b,y;(function(E){return E.indexOf("#")!==-1&&E.indexOf("?")!==-1&&E.indexOf("#")<E.indexOf("?")})(i)||function(E){return E.indexOf("?")===-1&&E.indexOf("#")!==-1}(i)?(w=(s=I(i.split("#"),2))[0],u=s[1],b=(l=I((u===void 0?"":u).split("?"),2))[0],y=l[1]):(w=(c=I(i.split("?"),2))[0],m=c[1],y=(h=I((m===void 0?"":m).split("#"),2))[0],b=h[1]);var _=Ea(y,b);return"".concat(w,"?").concat("is_liff_external_open_window","=").concat(!!a).concat(_)}(r,o))}else me("openWindow",e);else window.open(e.url,"_blank")}var ql=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"openWindow"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(r){return qe(r)}},t}(v);var Sa=function(e){return typeof e=="object"&&e!==null&&function(t){return typeof t=="string"||t instanceof String}(e.type)};function Bo(e){return Promise.reject(f(L,e))}function Lr(e){if(!function(r){return Array.isArray(r)&&r.every(Sa)}(e))return Bo("Parameter 'messages' must be an array of { type, ... }");var t=e.length;return t<1||t>5?Bo("Number of messages should be in range 1 to ".concat(5,".")):D(k("message"),{method:"POST",body:JSON.stringify({messages:e})}).catch(Ta)}var Ta=function(e){if(e.code==="403"){var t=J()==="12.0.0",r=R()==="ios",n=Be();t&&(r||n)&&window.alert("LINE\u30A2\u30D7\u30EA\u3092LINE 12.0.1\u4EE5\u964D\u306B\u30A2\u30C3\u30D7\u30C7\u30FC\u30C8\u3057\u3066\u304F\u3060\u3055\u3044\u3002\nPlease update your LINE app to LINE 12.0.1 or later.")}throw e},rf=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"sendMessages"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return ge(Lr,"chat_message.write")},t}(v);function Or(){return D(k("friendship"))}var cf=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"getFriendship"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return ge(Or,"profile")},t}(v);function Aa(){return d(this,void 0,void 0,function(){var e,t;return p(this,function(r){switch(r.label){case 0:if(!H())return[3,6];r.label=1;case 1:return r.trys.push([1,5,,6]),(e=Oe())&&e.sub?[2,e.sub]:[3,2];case 2:return[4,lt()];case 3:if((t=r.sent())&&t.userId)return[2,t.userId];r.label=4;case 4:return[3,6];case 5:return r.sent(),T.debug("can't retrieve Mid/Uid because of something wrong"),[3,6];case 6:return[2]}})})}function Ca(){return d(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,Aa()];case 1:return(e=t.sent())&&e.substring(0,1)==="u"?[2,e]:[2]}})})}var Wo=function(e){function t(){var r=e.apply(this,N([],I(arguments),!1))||this;return r.utsExtra={isLiffSuccessful:!1,isLoggedIn:!1,id:"",version:""},r.injected=!1,r}return g(t,e),Object.defineProperty(t,"CUSTOMPLACEID_INIT",{get:function(){return"liff.init"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CUSTOMTYPE",{get:function(){return"liffSdk"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"LiffUtsLoginStatus",{get:function(){return{isLoggedIn:1,isLiffSuccessful:2}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"analytics"},enumerable:!1,configurable:!0}),t.prototype.install=function(r){var n=r.liff,o=r.internalHooks;this.liffCore=n,o.init.beforeFinished(this.beforeInitFinished.bind(this)),o.init.beforeSuccess(this.beforeInitSuccess.bind(this)),o.init.error(this.initError.bind(this))},t.prototype.changeRatioToUTSFormat=function(r){if(r&&Number.isFinite(r))return Math.round(100*r)},t.prototype.setExtra=function(){var r,n=this.utsExtra,o=n.isLiffSuccessful,i=n.isLoggedIn,a=n.id,s=n.version,u=(i?t.LiffUtsLoginStatus.isLoggedIn:0)|(o?t.LiffUtsLoginStatus.isLiffSuccessful:0);(r=this.uts)===null||r===void 0||r.setExtra("liff",{id:a,loginStatus:u,version:s})},t.prototype.assignUtsExtra=function(r){Object.assign(this.utsExtra,r)},t.prototype.setVersion=function(r){this.assignUtsExtra({version:r}),T.debug("[LIFFUTS][SDK version] ".concat(r)),this.setExtra()},t.prototype.setLiffId=function(r){this.assignUtsExtra({id:r}),T.debug("[LIFFUTS][LIFFID] ".concat(r)),this.setExtra()},t.prototype.setIsLoggedIn=function(r){this.assignUtsExtra({isLoggedIn:r}),T.debug("[LIFFUTS][isLoggedIn] ".concat(r)),this.setExtra()},t.prototype.sendLiffInit=function(){var r;T.debug("[LIFFUTS][sendCustom] liff.init"),(r=this.uts)===null||r===void 0||r.sendCustom({type:t.CUSTOMTYPE,params:{placeId:t.CUSTOMPLACEID_INIT}})},t.prototype.setIsLiffSuccessful=function(r){this.assignUtsExtra({isLiffSuccessful:r}),T.debug("[LIFFUTS][isLiffInitSuccessful] ".concat(r)),this.setExtra()},t.prototype.prepareReferrer=function(r){var n={};Object.keys(r).forEach(function(o){if(an.includes(o)){var i=r[o];typeof i=="string"&&i&&(n[o.replace(/^liff\.ref\./,"")]=i)}}),Object.keys(n).length>0&&(this.referrer=n)},t.prototype.beforeInitFinished=function(){return d(this,void 0,void 0,function(){var r,n,o,i,a,s,u,l,c,m,h,w;return p(this,function(b){switch(b.label){case 0:if(r=j.parse(window.location.search),this.prepareReferrer(r),n=F(),!(o=n==null?void 0:n.utsTracking))return[2];if(i=P(),a=i.liffId,s=i.analytics,o.mode!=="auto"||!s)return[3,6];T.debug("[LIFFUTS] ".concat(new Date().toUTCString())),b.label=1;case 1:return b.trys.push([1,3,,4]),u=this,[4,new Promise(function(y,_){var E=window.uts,A=document.createElement("script");A.type="text/javascript",A.src="https://static.line-scdn.net/uts/edge/4.1.0/uts.js",A.onload=function(){var Z=window.uts;y(Z),window.uts=E},A.onerror=function(Z){_(Z)},document.getElementsByTagName("head")[0].appendChild(A)})];case 2:return u.uts=b.sent(),[3,4];case 3:return l=b.sent(),T.debug("[LIFFUTS] cannot load UTS, reason: ".concat(l)),[2];case 4:return c=M(M({},s.context),{utsId:s.context.utsId,appName:s.context.appName,appEnv:s.context.appEnv||"release"}),m=M(M({endpoint:"https://uts-front.line-apps.com"},s.options),{sampleRate:this.changeRatioToUTSFormat(o.sendRatio),version:"current"}),this.uts.init(c,m),[4,Ca()];case 5:(h=b.sent())&&(T.debug("[LIFFUTS][mid] ".concat(h)),this.uts.setMid(h)),n!=null&&n.tid&&(T.debug("[LIFFUTS][tid] ".concat(n.tid)),this.uts.setTid(n.tid)),this.referrer&&(T.debug("liff.ref.referrer",this.referrer),this.uts.setSessionParams(this.referrer)),a&&this.setLiffId(a),this.setIsLoggedIn(H()),this.setVersion(ye()),w=Yt(location.href),T.debug("[LIFFUTS][url] ".concat(w)),this.uts.setUrl(w),this.liffCore.analytics=this.uts,this.injected=!0,b.label=6;case 6:return[2]}})})},t.prototype.beforeInitSuccess=function(){return this.injected&&(this.setIsLiffSuccessful(!0),this.sendLiffInit()),Promise.resolve()},t.prototype.initError=function(){return this.injected&&(this.setIsLiffSuccessful(!1),this.sendLiffInit()),Promise.resolve()},t}(v),jo=function(e){T.debug("[LIFFUTS][sendCustom] liff.shareTargetPicker"),e.sendCustom({type:"liffSdk",params:{placeId:"liff.shareTargetPicker"}})};var La=/([\x90\x9D\x81\x8D\x8F<"{|}>\\^`“›„•‚ŽŠ…’—ž–‘”‡™‰ŒšŸ‹œ†¥¿©áÄýÍÎðô]|\n|.*#.*#|%(?![0-9A-Fa-f]{2})[^%]{0,2})/,Go=function(e){if(La.test(e))throw f(L,"invalid URL.");var t=new URL(e),r=t.username,n=t.password,o=t.hash,i=t.search;return{username:r,password:n,pathname:t.pathname,hash:o,origin:t.origin,search:i}},Ho=function(e){return e.substring(1).split("&").filter(function(t){return!/^liff\./.test(t)&&!!t})},Oa=function(e,t){var r=e.substring(t.length);return r==="/"?"":(r.length>0&&r[0]!=="/"&&(r="/"+r),r)},Vo=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})},Na=function(e,t){var r=function(n,o){for(var i=N([],I(n),!1),a=0;a<o.length;a++){var s=o[a],u=i.indexOf(s);u>-1&&i.splice(u,1)}return i}(function(n){var o,i,a=n.replace(/\+/g,"%2B"),s=new URLSearchParams(a),u=[];try{for(var l=ve(s.entries()),c=l.next();!c.done;c=l.next()){var m=I(c.value,2),h=m[0],w=m[1];u.push("".concat(Vo(h),"=").concat(Vo(w)))}}catch(y){o={error:y}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}if(u.length===0)return[""];var b=n.split("&");return u.map(function(y,_){return y.endsWith("=")&&!b[_].endsWith("=")?y.slice(0,-1):y})}(Ho(e).join("&")),Ho(t)).join("&");return r!==""?"?".concat(r):""},Pa=function(e){var t=new RegExp("^".concat(Qe.join("|"))),r=e.substring(1).split("&").filter(function(n){return!t.test(n)&&!!n}).join("&");return r?"#".concat(r):""},Ko=function(e,t){return t.indexOf(e)===0&&(e.endsWith("/")&&(e=e.substring(0,e.length-1)),t[e.length]===void 0||t[e.length]==="/")},Nr=function(e,t){var r=Go(e),n=new URL(t);if(r.username!==n.username||r.password!==n.password)throw f(L,"invalid URL.");if(n.origin!==r.origin||!Ko(n.pathname,r.pathname))throw f(L,"invalid URL.")},xa=function(e){function t(){var r=e.apply(this,N([],I(arguments),!1))||this;return r.extraParams="",r.getAndValidateContext=function(){var n=F();if(!n)throw f(U,"Could not get Context from server.");if(!n.endpointUrl)throw f(U,"Could not get endpointUrl from server.");if(!n.permanentLinkPattern)throw f(U,"Could not get permanentLinkPattern from server.");return n},r.createUrl=function(){var n=r.getAndValidateContext(),o=window.location,i=o.pathname,a=o.search,s=o.hash,u=o.origin,l=new URL(n.endpointUrl);if(l.origin!==u||!Ko(l.pathname,i))throw f(z,"Current page is not under entrypoint.");var c=i.substring(l.pathname.length);c.length>0&&c[0]!=="/"&&(c="/"+c);var m=new RegExp("^".concat(Qe.join("|"))),h=s.substring(1).split("&").filter(function(ee){return!m.test(ee)&&!!ee}).join("&"),w=h===l.hash.substring(1)?"":h,b=function(ee){return ee.substring(1).split("&").filter(function(de){return!/liff\.state/.test(de)&&!!de})},y=b(a),_=b(l.search);r.extraParams&&y.push(r.extraParams);for(var E=0;E<_.length;E++){var A=_[E],Z=y.indexOf(A);Z>-1&&y.splice(Z,1)}var K=y.join("&"),fe="".concat(c).concat(K!==""?"?".concat(K):"").concat(w?"#".concat(w):"");return"".concat(Re).concat(P().liffId).concat(fe)},r.createUrlBy=function(n){return d(r,void 0,void 0,function(){var o,i,a,s,u,l;return p(this,function(c){if(!(o=P().liffId))throw f(U,"Should run after liff init.");return i=this.getAndValidateContext(),Nr(n,i.endpointUrl),a=Go(n),s=new URL(i.endpointUrl),u=i.miniDomainAllowed?Xe:Re,l=i.miniDomainAllowed&&i.miniAppId?i.miniAppId:o,[2,u.concat(l,Oa(a.pathname,s.pathname),Na(a.search,s.search),Pa(a.hash))]})})},r.setExtraQueryParam=function(n){r.extraParams=n},r.install=function(){return{createUrl:r.createUrl,createUrlBy:r.createUrlBy,setExtraQueryParam:r.setExtraQueryParam}},r}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"permanentLink"},enumerable:!1,configurable:!0}),t}(v),qo=new xa;var Je,ka=function(){function e(t,r){var n=this;this.resolve=t,this.reject=r,this.onSubmit=function(o){var i=o.message;n.resolve({value:i}),n.destroy()},this.onClose=function(){n.resolve({value:null}),n.destroy()},this.onCancel=function(){n.resolve({value:null}),n.destroy()},this.onError=function(o){n.reject(o),n.destroy()},this.start()}return e.prototype.start=function(){X.on("submit",this.onSubmit),X.on("close",this.onClose),X.on("cancel",this.onCancel),X.on("error",this.onError)},e.prototype.destroy=function(){X.off("submit",this.onSubmit),X.off("close",this.onClose),X.off("cancel",this.onCancel),X.off("error",this.onError),Je=void 0},e}();function Ma(){return d(this,void 0,void 0,function(){return p(this,function(e){return oe.scanCodeV2(),Je&&Je.destroy(),[2,new Promise(function(t,r){Je=new ka(t,r),X.open({url:"https://liff.line.me/1656359117-jxmx5e11"}).catch(function(n){Je==null||Je.destroy(),r(n)})})]})})}var Da=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"scanCodeV2"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return Ma},t}(v),Jo=new Da;var zo={};function Ra(){return zo}function Pr(e,t){var r=Ra(),n=I(t.split("."),1)[0],o=r[t];o&&e.removeEventListener(n,o),r[t]=null}var $o=!1,Yo=!1;function Ua(e,t,r,n){$o||(Yo=function(){var i=!1;try{var a=Object.defineProperty({},"passive",{get:function(){return i=!0,!1}});window.addEventListener("test",a,a),window.removeEventListener("test",a,a)}catch{i=!1}return i}(),$o=!0);var o=I(t.split("."),1)[0];return new Promise(function(i){var a=function(s){i(s),r&&r(s),n&&n.once&&Pr(e,t)};(function(s,u){zo[s]=u})(t,a),e.addEventListener(o,a,!!Yo&&n)})}function xr(e,t,r,n){if(r===void 0&&(r={}),typeof e!="object"||!e.postMessage)throw f(L,"target must be window object");if(typeof t!="string")throw f(L,"keyname must be string");if(typeof r!="object")throw f(L,"incorrect body format. It should be Object or Array comprised of Object");if(!n)throw f(L,"serverEndPointUrl isn't passed. please fill up with proper url");if(n==="*")throw new Error("serverEndPointUrl doesn't allow to set '*'");var o={name:t,body:r};e.postMessage(o,n)}function Xo(e,t,r,n){Ua(e,"message.".concat(t),function(o,i,a){return function(s){T.debug("messageReceive",s),s.origin===a&&s.data.name===o&&i(s)}}(t,r,n))}var Fa=function(){function e(){this.payloadToShareTargetPicker=null,this.popupWindow=null,this.doesWaitForSubwindowResult=!1}return e.getInstance=function(){return e.instance?e.instance.reset():e.instance=new e,e.instance},e.prototype.init=function(t){return d(this,void 0,void 0,function(){var r,n;return p(this,function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),this.liffId=t.referrer.liffId,this.doesWaitForSubwindowResult=!(!t.options||!t.options.waitForSubwindowResult),this.allowPostMessageOrigin=this.initAllowPostMessageOrigin(),this.payloadToShareTargetPicker=this.buildPayloadToShareTargetPicker(t),window.AbortController&&(this.abortController=new window.AbortController),this.prepareAnotherWindow(),[4,this.initOtt()];case 1:return o.sent(),this.initListener(),this.openAnotherWindow(),this.doesWaitForSubwindowResult?[4,this.pollingShareResult()]:[3,3];case 2:return r=o.sent(),this.finalize(),[2,r];case 3:case 6:return[2];case 4:return[3,6];case 5:if(n=o.sent(),this.finalize(),n.name!=="AbortError")throw n;return[3,6]}})})},e.prototype.resetAllVariables=function(){this.liffId="",this.allowPostMessageOrigin="",this.payloadToShareTargetPicker=null,this.ott="",this.popupWindow=null,this.timeoutIDForHealthCheck=null,this.abortController=null,this.internalError=null,this.doesWaitForSubwindowResult=!1},e.prototype.reset=function(){this.finalize(),this.resetAllVariables()},e.prototype.finalize=function(){var t,r;this.abortController&&this.abortController.abort(),S()||(t=this.timeoutIDForHealthCheck,r=this.popupWindow,Pr(window,"message.receivedHealthcheck"),t&&clearTimeout(t),r&&!r.closed&&r.close())},e.prototype.buildPayloadToShareTargetPicker=function(t){return{messages:t.messages,isMultiple:t.isMultiple,referrer:t.referrer}},e.prototype.initAllowPostMessageOrigin=function(t){return t===void 0&&(t=k("shareTargetPicker")),wn(t)},e.prototype.initOtt=function(){return d(this,void 0,void 0,function(){var t,r,n;return p(this,function(o){switch(o.label){case 0:return this.abortController&&(t=this.abortController.signal),r="".concat(k("shareTargetPickerOtt"),"/").concat(this.liffId,"/ott"),n=this,[4,D(r,{method:"GET",signal:t}).then(function(i){return i.ott})];case 1:return n.ott=o.sent(),[2]}})})},e.prototype.prepareAnotherWindow=function(){S()||(R()!=="ios"||Be()?this.popupWindow=window.open("","liffpopup","width=480, height=640, menubar=no, toolbar=no, scrollbars=yes"):this.popupWindow=window.open())},e.prototype.openAnotherWindow=function(){if(S()&&this.payloadToShareTargetPicker)t=this.liffId,r=this.ott,n=this.payloadToShareTargetPicker,o={liffId:t,ott:r,data:JSON.stringify(n),closeModals:!1},location.href="".concat("line://picker","?").concat(j.stringify(o));else{if(this.timeoutIDForHealthCheck=window.setTimeout(this.healthCheck.bind(this),1e3),!this.popupWindow)throw f(Ye);(function(i,a,s){var u={liffId:a,ott:s};i.location.href="".concat(k("shareTargetPicker"),"?").concat(j.stringify(u))})(this.popupWindow,this.liffId,this.ott)}var t,r,n,o},e.prototype.initListener=function(){var t,r;S()||(t=this.onReceivedHealthcheck.bind(this),r=this.allowPostMessageOrigin,Xo(window,"receivedHealthcheck",t,r))},e.prototype.healthCheck=function(){return d(this,void 0,void 0,function(){var t;return p(this,function(r){switch(r.label){case 0:if(this.popupWindow&&!this.popupWindow.closed)return[3,7];if(!this.doesWaitForSubwindowResult)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.onCanceled()];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.internalError=t,[3,4];case 4:return[3,6];case 5:this.finalize(),r.label=6;case 6:return[3,8];case 7:n=this.popupWindow,o=this.allowPostMessageOrigin,xr(n,"healthcheck",void 0,o),this.timeoutIDForHealthCheck=window.setTimeout(this.healthCheck.bind(this),1e3),r.label=8;case 8:return[2]}var n,o})})},e.prototype.onReceivedHealthcheck=function(){if(!this.popupWindow||!this.payloadToShareTargetPicker)throw f(Ye);var t,r,n;t=this.popupWindow,r=this.payloadToShareTargetPicker,n=this.allowPostMessageOrigin,xr(t,"ready",r,n)},e.prototype.onCanceled=function(){return d(this,void 0,void 0,function(){var t,r;return p(this,function(n){switch(n.label){case 0:if(S()||!this.ott)throw new Error("need to call with ott in client");return this.abortController&&(t=this.abortController.signal),r={liffId:this.liffId,ott:this.ott},[4,D("".concat(k("shareTargetPickerResult"),"?").concat(j.stringify(r)),{method:"POST",signal:t,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:"result=CANCEL"})];case 1:return[2,n.sent().status==="ok"]}})})},e.prototype.getShareResult=function(){return d(this,void 0,void 0,function(){var t,r;return p(this,function(n){if(!this.ott)throw new Error("need to call with ott in client");return this.abortController&&(t=this.abortController.signal),r={liffId:this.liffId,ott:this.ott},T.debug("fetch: getShareResult"),[2,D("".concat(k("shareTargetPickerResult"),"?").concat(j.stringify(r)),{method:"GET",headers:{Accept:"application/json"},signal:t})]})})},e.isPollingTimeOut=function(t,r){return(r-t)/6e4>=10},e.prototype.pollingShareResult=function(){return d(this,void 0,void 0,function(){var t,r;return p(this,function(n){switch(n.label){case 0:t=Date.now(),n.label=1;case 1:if(e.isPollingTimeOut(t,Date.now()))return[3,4];if(this.internalError)throw this.internalError;return[4,this.getShareResult()];case 2:if((r=n.sent())&&r.result)switch(r.result){case"SUCCESS":return[2,{status:"success"}];case"CANCEL":return[2];default:throw new Error(r.resultDescription)}return[4,new Promise(function(o){setTimeout(o,500)})];case 3:return n.sent(),[3,1];case 4:throw new Error("Timeout: not finished within ".concat(10,"min"))}})})},e}(),Ba=function(e){function t(){var r=e.apply(this,N([],I(arguments),!1))||this;return r.shareTargetPicker=function(n){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return d(r,N([n],I(o),!1),void 0,function(a,s){var u,l,c,m,h,w,b;return s===void 0&&(s={}),p(this,function(y){switch(y.label){case 0:if(oe.shareTargetPicker(),!a||!Array.isArray(a)||a.length===0)throw f(L,"no proper argument");if(a.length>on)throw f(L,"exceed the limit of num of messages");if(!(u=P().liffId))throw f(z);window.liff&&(l=window.liff).analytics&&jo(l.analytics),c=s.isMultiple===void 0||s.isMultiple,y.label=1;case 1:return y.trys.push([1,3,,4]),m=Fa.getInstance(),h=J(),w={waitForSubwindowResult:!0},S()&&h&&G(h,"10.11.0")<0&&(w.waitForSubwindowResult=!1),[4,m.init({messages:a,isMultiple:c,referrer:{liffId:u,url:location.origin},options:w})];case 2:return[2,y.sent()];case 3:throw(b=y.sent())instanceof Jt?b:f(ze,b.message);case 4:return[2]}})})},r}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"shareTargetPicker"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return this.shareTargetPicker},t}(v),Qo=new Ba;function Zo(e,t){return d(this,void 0,void 0,function(){var r,n;return p(this,function(o){switch(o.label){case 0:return r=k("createShortcutOnHomeScreen"),(n=new URL(r)).searchParams.append("liffId",e),n.searchParams.append("url",t.url),t.description&&n.searchParams.append("description",t.description),[4,D(n.toString())];case 1:return[2,o.sent().shortcutPageUrl]}})})}function ei(e){if(mt(e))throw f(L,"LINE URL scheme are not supported in the current environment.")}function Wa(e,t){return d(this,void 0,void 0,function(){var r;return p(this,function(n){switch(n.label){case 0:return S()?[2]:[4,new Promise(function(o){setTimeout(o,1e3)})];case 1:return n.sent(),document.visibilityState==="hidden"?[2]:(ei(t.url),[4,Zo(e,t)]);case 2:return r=n.sent(),qe({url:r,external:!0}),[2]}})})}function ja(e,t){return d(this,void 0,void 0,function(){var r,n;return p(this,function(o){switch(o.label){case 0:return r={liffId:e,targetUrl:t.url,description:t.description},n="".concat("line://shortcut/liff","?").concat(j.stringify(r)),location.href=n,[4,Wa(e,t)];case 1:return o.sent(),[2]}})})}function Ha(e,t){return d(this,void 0,void 0,function(){var r;return p(this,function(n){switch(n.label){case 0:return ei(t.url),[4,Zo(e,t)];case 1:return r=n.sent(),qe({url:r,external:!0}),[2]}})})}function ti(e){var t;if(e.url===void 0||e.url===null||e.url==="")throw f(L,"no proper argument");var r=F();if(!(!((t=r==null?void 0:r.availability.addToHomeLineScheme)===null||t===void 0)&&t.permission)){if(mt(e.url))throw f(C,"No permission to specify line schema in url.");if(e.description)throw f(C,"No permission to specify description.")}if(!mt(e.url)){if(!r)throw f(C,"Could not get Context from server.");r.liffId!==et(e.url)&&Nr(e.url,r.endpointUrl)}}function Va(e){return d(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return ti(e),oe.internalCreateShortcutOnHomeScreen(),[4,ri(e)];case 1:return t.sent(),[2]}})})}function Ga(e){return d(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return ti(e),oe.createShortcutOnHomeScreen(),[4,ri(e)];case 1:return t.sent(),[2]}})})}function ri(e){return d(this,void 0,void 0,function(){var t;return p(this,function(r){switch(r.label){case 0:if(!(t=P().liffId))throw f(U,"Invalid LIFF ID.");return R()==="ios"?[4,Ha(t,e)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,ja(t,e)];case 3:r.sent(),r.label=4;case 4:return[2]}})})}var ni=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"createShortcutOnHomeScreen"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(r){return Ga(r)}},t}(v),oi=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"internalCreateShortcutOnHomeScreen"},enumerable:!1,configurable:!0}),t.prototype.install=function(){return function(r){return Va(r)}},t}(v);function Ka(e){return d(this,arguments,void 0,function(t){var r=t.productIds;return p(this,function(n){switch(n.label){case 0:return[4,me("iap.getPlatformProducts",{productIds:r}).catch(function(o){throw o.code&&o.description?f(o.code,o.description):f(W,"Failed to get platform products",{cause:o})})];case 1:return[2,n.sent().products]}})})}var qa=function(e){return d(void 0,[e],void 0,function(t){var r=t.productId,n=t.orderId;return p(this,function(o){switch(o.label){case 0:return[4,me("iap.createPayment",{productId:r,orderId:n}).catch(function(i){throw i.code&&i.description?f(i.code,i.description):f(W,"Failed to get platform products",{cause:i})})];case 1:return o.sent(),[2]}})})},ii=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return g(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"iap"},enumerable:!1,configurable:!0}),t.prototype.install=function(){var r=this;return{getPlatformProducts:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return d(r,void 0,void 0,function(){return p(this,function(i){return oe.iap(),[2,Ka.apply(void 0,N([],I(n),!1))]})})},createPayment:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return d(r,void 0,void 0,function(){return p(this,function(i){return oe.iap(),[2,qa.apply(void 0,N([],I(n),!1))]})})},requestConsentAgreement:function(){return d(r,void 0,void 0,function(){return p(this,function(n){return oe.iap(),[2,d(void 0,void 0,void 0,function(){return p(this,function(o){switch(o.label){case 0:return[4,me("iap.requestConsentAgreement").catch(function(i){throw i.code&&i.description?f(i.code,i.description):f(W,"Failed to request consent agreement",{cause:i})})];case 1:return o.sent(),[2]}})})]})})}}},t}(v);var Ja={},kr=Object.defineProperties(Ja,{getOS:{value:R,enumerable:!0,writable:!0},getVersion:{value:ye,enumerable:!0,writable:!0},getLanguage:{value:Ar,enumerable:!0,writable:!0},getAppLanguage:{value:Cr,enumerable:!0,writable:!0},getOrigins:{value:Tr,enumerable:!0,writable:!0},isInClient:{value:S,enumerable:!0,writable:!0},isLoggedIn:{value:H,enumerable:!0,writable:!0},logout:{value:rt,enumerable:!0,writable:!0},getAccessToken:{value:ne,enumerable:!0,writable:!0},getIDToken:{value:je,enumerable:!0,writable:!0},getDecodedIDToken:{value:Oe,enumerable:!0,writable:!0},getContext:{value:F,enumerable:!0,writable:!0},openWindow:{value:qe,enumerable:!0,writable:!0},closeWindow:{value:we,enumerable:!0,writable:!0},getFriendship:{value:ge(Or,"profile"),enumerable:!0,writable:!0},getAId:{value:zt,enumerable:!0,writable:!0},getProfilePlus:{value:Qt,enumerable:!0,writable:!0},getIsVideoAutoPlay:{value:Xt,enumerable:!0,writable:!0},getLineVersion:{value:J,enumerable:!0,writable:!0},isApiAvailable:{value:Ie,enumerable:!0,writable:!0},getProfile:{value:ge(lt,"profile"),enumerable:!0,writable:!0},sendMessages:{value:ge(Lr,"chat_message.write"),enumerable:!0,writable:!0},subWindow:{value:X,enumerable:!0,writable:!0},ready:{value:nn,enumerable:!0,writable:!0},id:{get:function(){return P().liffId||null},enumerable:!0},_dispatchEvent:{value:qn,enumerable:!0,writable:!0},_call:{value:me,enumerable:!0,writable:!0},_addListener:{value:at,enumerable:!0,writable:!0},_removeListener:{value:st,enumerable:!0,writable:!0},_postMessage:{value:cr,enumerable:!0,writable:!0}}),Mr=new rn,ai=new tn(Mr,kr),$a=new Ft(Mr,ai).install();function Ya(e){$a.call(kr,e)}[new Ft(Mr,ai),new _o,new Mo,new Wo,Jo,qo,ar,Fo,Qo,So,new Bn,new ni,new oi,new ii].forEach(Ya);var $=kr;var Zd=(()=>{let t=class t{constructor(n,o){this._authService=n,this._userActive=o,this.tools=new Me,this.lineProfile={},this._unsubscribeAll=new Wr}get Profile(){return this.lineProfile||null}getLineProfile(n){return new ft(o=>{$.init({liffId:n},()=>{}).then(()=>{var i;!$.isLoggedIn()&&!((i=this.lineProfile)!=null&&i.userId)&&$.login(),$.getProfile().then(a=>{n&&this.tools.setLiffId(n),this.lineProfile=a,o.next(a)})})})}initLineLiff(n){var a;let o=(a=this.tools)==null?void 0:a.getLiffId(),i=n===""?o:n;if(i)return new Promise((s,u)=>{$.init({liffId:i},()=>{$.getProfile().then(l=>{this.tools.setLiffId(n),s(l)})}).then(()=>{$.isLoggedIn()||$.login(),$.getProfile().then(l=>{s(l)})})});{let s=this._userActive.activeUser;return new Promise((u,l)=>{u(s)})}}InitLine(n){return xe(this,null,function*(){return n||(alert("Warning LINE missing key"),Promise.resolve(!1)),new Promise((o,i)=>xe(this,null,function*(){console.log("keyLiff",n),yield $.init({liffId:n},()=>xe(this,null,function*(){if($.isLoggedIn()){let a=yield this.runAppLiff();o(a)}else $.login(),setTimeout(()=>xe(this,null,function*(){let a=yield this.runAppLiff();o(a)}))}))}))})}runAppLiff(){return new Promise((n,o)=>{try{$.getProfile().then(i=>xe(this,null,function*(){if(console.log("profile",i),!(i!=null&&i.userId))return;this.lineProfile=i;let a={accountId:i.userId,photoUrl:i.pictureUrl,accountName:i.displayName};console.log(":userInfo",a);let s=yield this.userSignUp(a);n(s)}))}catch(i){console.error(i),o(!1)}})}userSignUp(n){return n!=null&&n.userId||Promise.resolve(!1),this._authService.user(n).pipe(Hr(this._unsubscribeAll)).subscribe(o=>{if(console.log(136,"profile",o),o.status){let i=o.data;return this._userActive.setActiveUser(i),!0}else return!1})}close(){$.closeWindow()}sendMessages(n){$.sendMessages([{type:"text",text:n}]).then(()=>{$.closeWindow()})}sendFlexMessage(n){$.sendMessages(n).then(()=>$.closeWindow())}};t.\u0275fac=function(o){return new(o||t)($e(Jr),$e(qr))},t.\u0275prov=ke({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();export{Gr as a,qr as b,Me as c,Jr as d,Zd as e};
